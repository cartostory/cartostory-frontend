(function(t){function e(e){for(var n,i,c=e[0],s=e[1],l=e[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,c=1;c<r.length;c++){var s=r[c];0!==a[s]&&(n=!1)}n&&(o.splice(e--,1),t=i(i.s=r[0]))}return t}var n={},a={app:0},o=[];function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/cartostory-frontend/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=s;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"0f74":function(t,e,r){},"116c":function(t,e,r){"use strict";var n=r("9e12"),a=r.n(n);a.a},"294c2":function(t,e,r){"use strict";var n=r("6a99"),a=r.n(n);a.a},"56d7":function(t,e,r){"use strict";r.r(e);r("46a1"),r("450d");var n=r("e5f2"),a=r.n(n),o=(r("1f1a"),r("4e4b")),i=r.n(o),c=(r("7a0f"),r("0f6c")),s=r.n(c),l=(r("6611"),r("e772")),u=r.n(l),d=(r("de31"),r("c69e")),f=r.n(d),p=(r("be4f"),r("896a")),h=r.n(p),b=(r("10cb"),r("f3ad")),m=r.n(b),y=(r("eca7"),r("3787")),g=r.n(y),v=(r("425f"),r("4105")),O=r.n(v),k=(r("bdc7"),r("aa2f")),j=r.n(k),_=(r("adec"),r("3d2d")),E=r.n(_),S=(r("f4f9"),r("c2cc")),w=r.n(S),x=(r("1951"),r("eedf")),C=r.n(x),T=(r("cadf"),r("551c"),r("f751"),r("097d"),r("a026")),A=r("2f62"),N=r("85ff"),P=r.n(N),$=(r("0ec9"),r("f13c")),M=r.n($),D=(r("f5df"),r("0fae"),r("a2f0"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{attrs:{id:"app"}},[r("router-view"),r("cs-notification"),t.loading?r("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}]}):t._e()],1)}),R=[],U=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div")},F=[],I=(r("ac6a"),"REMOVE_ERROR"),z="UPDATE_ERRORS",B="UPDATE_EDITABLE",V="UPDATE_FEATURE_MARK_CALLBACK",H="UPDATE_HIGHLIGHTED_LAT_LNG",J="UPDATE_LOADING",K="UPDATE_MAP_CENTER",G="UPDATE_STORY",q="UPDATE_STORY_NAME",Y="UPDATE_STORY_TEXT",W="UPDATE_STORY_URL",Z="UPDATE_TRACK",X={name:"CsNotification",computed:{errors:function(){var t=this;return this.$store.state.errors.forEach((function(e){t.$notify({type:"error",title:e.title,message:e.message,onClose:function(){t.$store.commit(I,e)},duration:0}),t.$store.commit(I,e)})),this.$store.state.errors}},watch:{errors:function(){return this.errors}}},Q=X,tt=r("2877"),et=Object(tt["a"])(Q,U,F,!1,null,null,null),rt=et.exports,nt={name:"app",components:{CsNotification:rt},computed:{loading:function(){return this.$store.state.loading}}},at=nt,ot=(r("5c0b"),Object(tt["a"])(at,D,R,!1,null,null,null)),it=ot.exports,ct=r("8c4f"),st=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-main",[r("el-row",[r("el-col",{attrs:{span:10,offset:7}},[r("h1",[t._v("Cartostory")]),r("el-form",{attrs:{"label-width":"120px"}},[t.availableStories.length>0?r("el-form-item",{attrs:{label:"Načíst příběh"}},[r("el-select",{attrs:{placeholder:"Příběh"},on:{change:t.handleStorySelect},model:{value:t.currentStory,callback:function(e){t.currentStory=e},expression:"currentStory"}},t._l(t.availableStories,(function(t){return r("el-option",{key:t.storyName,attrs:{label:t.storyName,value:t.storyName}})})),1)],1):t._e(),r("el-form-item",{attrs:{label:"URL příběhu"}},[r("el-input",{attrs:{type:"text"},model:{value:t.storyUrl,callback:function(e){t.storyUrl=e},expression:"storyUrl"}})],1),r("el-form-item",[r("el-button",{attrs:{disabled:t.disabledSubmit,type:"primary"},on:{click:t.handleSubmit}},[t._v("Načíst")])],1)],1)],1)],1)],1)},lt=[],ut=(r("8e6e"),r("456d"),r("7514"),r("96cf"),r("3b8d")),dt=(r("7f7f"),r("bd86")),ft=r("f788"),pt=r.n(ft);function ht(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(r),!0).forEach((function(e){Object(dt["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var mt={name:"CsLoadStoryForm",data:function(){return{currentStory:void 0}},computed:bt({},Object(A["c"])({availableStories:function(t){return t.availableStories},storyName:function(t){return t.story.name},storyText:function(t){return t.story.text}}),{disabledSubmit:function(){return!this.storyUrl},storyUrl:{get:function(){return this.$store.state.storyUrl},set:function(t){this.$store.commit(W,t)}}}),methods:{handleSubmit:function(){var t=Object(ut["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("loadStory");case 3:e=pt()(this.storyName).toLowerCase(),this.$router.push("/story/read/".concat(e)),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$store.commit(z,{title:"Příběh se nepodařilo nahrát",message:"Zkontrolujte jeho adresu."});case 10:return t.prev=10,this.$store.commit(J,!1),t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,7,10,13]])})));function e(){return t.apply(this,arguments)}return e}(),handleStorySelect:function(){var t=this,e=this.availableStories.find((function(e){return e.storyName===t.currentStory}));e&&(this.storyUrl=e.storyUrl)}}},yt=mt,gt=(r("6a5e"),Object(tt["a"])(yt,st,lt,!1,null,"442b84f5",null)),vt=gt.exports,Ot=(r("c5f6"),r("5df2"),r("75fc")),kt=(r("20d6"),r("bc3a")),jt=r.n(kt),_t=r("89c7"),Lt=r.n(_t),Et=r("c2d0"),St=r("7e8c"),wt=(r("28a5"),"data-cs-lat"),xt="data-cs-lng",Ct=$t(wt),Tt=$t(xt),At="mark-click",Nt="add-feature-mark",Pt="track-file-upload";function $t(t){return t.split("-").map((function(t,e){return e>0?t.slice(0,1).toUpperCase()+t.slice(1):t})).join("")}var Mt,Dt=function(t){return t[t.length-1]},Rt=function(t){return function(e,r){e[t]=r}},Ut=function(t){return function(e,r){var n=t.slice(0,-1).reduce((function(e,r,n){return r in e||(e[r]="number"===typeof t[n+1]?[]:{}),e[r]}),e);n[Dt(t)]=r}};T["default"].use(A["a"]);var Ft={editable:!1,errors:[],loading:!1,storyUrl:void 0,story:{name:void 0,text:void 0,track:void 0},addFeatureMarkCallback:void 0,availableStories:[],highlightedLatLng:void 0},It=(Mt={},Object(dt["a"])(Mt,I,(function(t,e){var r=t.errors.findIndex((function(t){return t.title===e.title&&t.message===e.message}));r>-1&&t.errors.splice(r,1)})),Object(dt["a"])(Mt,B,Rt("editable")),Object(dt["a"])(Mt,z,(function(t,e){t.errors=[].concat(Object(Ot["a"])(t.errors),[e])})),Object(dt["a"])(Mt,V,Rt("addFeatureMarkCallback")),Object(dt["a"])(Mt,H,(function(t,e){t.highlightedLatLng={lat:Number.parseFloat(e[wt]),lng:Number.parseFloat(e[xt])}})),Object(dt["a"])(Mt,J,Rt("loading")),Object(dt["a"])(Mt,K,Ut(["map","center"])),Object(dt["a"])(Mt,G,Rt("story")),Object(dt["a"])(Mt,q,Ut(["story","name"])),Object(dt["a"])(Mt,Y,Ut(["story","text"])),Object(dt["a"])(Mt,W,Rt("storyUrl")),Object(dt["a"])(Mt,Z,Ut(["story","track"])),Mt),zt={updateTrack:function(t,e){var r=t.commit;r(Z,e)},updateStoryText:function(t,e){var r=t.commit;r(Y,e)},loadStory:function(){var t=Object(ut["a"])(regeneratorRuntime.mark((function t(e){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,n=e.state,r(J,!0),t.next=4,jt.a.get(n.storyUrl);case 4:a=t.sent,r(G,a.data);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},Bt={features:function(t){var e=[],r=void 0;if(r=t.story.text&&t.story.text.state?t.story.text.state.doc.content:t.story.text&&t.story.text.content,r){var n=JSON.parse(JSON.stringify(r)),a=Object(Et["a"])(Object(St["a"])(n,[wt,xt]),(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t}));e=Lt()(a,2).map((function(t){return{lat:t[0],lng:t[1]}}))}return e},featuresWithoutHighlighted:function(t,e){if(!t.highlightedLatLng)return e.features;var r=t.highlightedLatLng,n=r.lat,a=r.lng;return e.features.filter((function(t){return t.lat!==n&&t.lng!==a}))}},Vt=new A["a"].Store({strict:!0,getters:Bt,state:Ft,mutations:It,actions:zt}),Ht=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-main",[r("el-col",{attrs:{span:10,offset:7}},[r("el-row",[r("h1",[t._v("Cartostory")])]),r("el-row",[r("el-col",{staticClass:"section",attrs:{span:12}},[r("h2",[t._v("Napsat příběh")]),r("p",[t._v("Chcete napsat svůj vlastní příběh? Z prázdnin, dovolené nebo jen zajímavého sobotního\n          výletu?")]),r("el-button",{on:{click:function(e){return t.$router.push("/story/create")}}},[t._v("Chci psát")])],1),r("el-col",{staticClass:"section",attrs:{span:12}},[r("h2",[t._v("Číst příběh")]),r("p",[t._v("Váš kamarád nebo příbuzný napsal příběh a poslal vám jeho adresu? Můžete si ho přečíst.")]),r("el-button",{on:{click:function(e){return t.$router.push("/story/load")}}},[t._v("Chci číst")])],1)],1)],1)],1)},Jt=[],Kt={name:"Landing"},Gt=Kt,qt=(r("ee88"),Object(tt["a"])(Gt,Ht,Jt,!1,null,"71137e5c",null)),Yt=qt.exports,Wt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{staticClass:"story-form"},[r("el-col",{attrs:{span:12}},[r("cs-map")],1),r("el-col",{staticClass:"story-form__story",attrs:{span:12}},[t.$store.state.story.text||t.ready?r("cs-editor",{staticStyle:{flex:"1",overflow:"auto"},on:t._d({},[t.ADD_FEATURE_MARK_EVENT,function(e){return t.handleAddFeatureMarkClick(e)}])}):t._e(),t.editable?r("el-footer",{staticStyle:{margin:"auto"}},[r("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("Uložit")])],1):t._e()],1)],1)},Zt=[],Xt=r("ea97"),Qt=r("2253c"),te=r("044a"),ee=r("2699"),re=r("a40a"),ne=r("fb8e"),ae={bounds:void 0,center:[50,19],baseLayer:"https://api.mapbox.com/styles/v1/cartostory/cjugqcypf27581gnry4y59lxy/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",hikingOverlay:"http://tile.mtbmap.cz/overlay_hiking/{z}/{x}/{y}.png",labelsOverlay:"https://api.mapbox.com/styles/v1/cartostory/cjugqfe8r1lhh1ftgrmr7v9zj/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",zoom:8,edgeMarker:void 0},oe={style:{common:{radius:8,weight:1.5},highlighted:{color:"#F56C6C",opacity:1,fillOpacity:.4},inBbox:{color:"#42b983",fillOpacity:.5},plain:{color:"#3185fc",fillOpacity:.5},edge:{icon:L.icon({iconUrl:"../../node_modules/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]})}}},ie={style:{plain:{color:"#5a5a66",dashArray:"6"},inBbox:{color:"#42b983",dashArray:"6"}}},ce=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-col",{staticStyle:{flex:"1 1 0%",overflow:"hidden",display:"flex","flex-wrap":"wrap","flex-direction":"column"}},[t.editable?r("el-form",[r("el-form-item",[r("el-input",{staticClass:"story-name",attrs:{placeholder:"Název příběhu..."},model:{value:t.storyName,callback:function(e){t.storyName=e},expression:"storyName"}})],1)],1):t._e(),t.editable?t._e():r("h1",{staticClass:"is-title-1"},[t._v(t._s(t.storyName))]),t.editable?r("editor-menu-bar",{staticStyle:{background:"white"},attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.commands,a=e.isActive;return[r("div",{staticClass:"editor-menu-bar"},[r("el-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:2})},attrs:{title:"Nadpis 1. úrovně",size:"mini",type:"plain"},on:{click:function(t){return n.heading({level:2})}}},[t._v("\n        H1\n      ")]),r("el-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:3})},attrs:{title:"Nadpis 2. úrovně",size:"mini",type:"plain"},on:{click:function(t){return n.heading({level:3})}}},[t._v("\n        H2\n      ")]),r("el-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:4})},attrs:{title:"Nadpis 3. úrovně",size:"mini",type:"plain"},on:{click:function(t){return n.heading({level:4})}}},[t._v("\n        H3\n      ")])],1)]}}],null,!1,2683553699)}):t._e(),t.editable?r("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":t.keepInBounds},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.commands,a=e.getMarkAttrs,o=e.isActive,i=e.menu;return[r("div",{staticClass:"menububble",class:{"is-active":i.isActive},style:"left: "+i.left+"px; bottom: "+i.bottom+"px;"},[t.isNewFeatureMarkButtonVisible(a("featureMark"))?t._e():r("el-button",{staticClass:"menububble__button",class:{"is-active":o.featureMark()},attrs:{icon:"el-icon-location-outline"},on:{click:function(e){return t.handleAddFeatureMarkClick(n.featureMark)}}}),t.isNewFeatureMarkButtonVisible(a("featureMark"))?r("el-button",{staticClass:"menububble__button",class:{"is-active":o.featureMark()},attrs:{icon:"el-icon-delete-location"},on:{click:function(t){return n.featureMark()}}}):t._e()],1)]}}],null,!1,2757025300)}):t._e(),t.editor?r("editor-content",{staticClass:"editor",class:{editable:this.editable},staticStyle:{flex:"1",overflow:"auto"},attrs:{editor:t.editor}}):t._e()],1)},se=[],le=r("cd42"),ue=r("f23d"),de=(r("6b54"),r("2397"),r("d225")),fe=r("b0b4"),pe=r("308d"),he=r("6bb5"),be=r("4e2b"),me=r("a9de");function ye(t){return function(){var e,r=Object(he["a"])(t);if(ge()){var n=Object(he["a"])(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return Object(pe["a"])(this,e)}}function ge(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var ve="a",Oe=function(t){Object(be["a"])(r,t);var e=ye(r);function r(){return Object(de["a"])(this,r),e.apply(this,arguments)}return Object(fe["a"])(r,[{key:"commands",value:function(t){var e=t.type;return function(t){var r;return Object(me["r"])(e,(r={},Object(dt["a"])(r,wt,t&&t[wt]),Object(dt["a"])(r,xt,t&&t[xt]),r))}}},{key:"name",get:function(){return"featureMark"}},{key:"schema",get:function(){var t;return{attrs:(t={},Object(dt["a"])(t,wt,{default:null}),Object(dt["a"])(t,xt,{default:null}),t),parseDOM:[{tag:ve,getAttrs:function(t){var e;return e={},Object(dt["a"])(e,wt,t.dataset[wt]),Object(dt["a"])(e,xt,t.dataset[xt]),e}}],toDOM:function(t){var e;return[ve,(e={},Object(dt["a"])(e,wt,t.attrs[wt]),Object(dt["a"])(e,xt,t.attrs[xt]),e),0]}}}},{key:"view",get:function(){var t;return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t,e=(t={},Object(dt["a"])(t,wt,this[Ct]),Object(dt["a"])(t,xt,this[Tt]),t);this.$store.commit(H,e)}},computed:(t={isHighlighted:function(){if(!this.$store.state.highlightedLatLng)return!1;var t=this.$store.state.highlightedLatLng,e=t.lat,r=t.lng;return e===this[Ct]&&r===this[Tt]}},Object(dt["a"])(t,Ct,{get:function(){return this.node.attrs[wt]},set:function(t){this.updateAttrs(Object(dt["a"])({},wt,t))}}),Object(dt["a"])(t,Tt,{get:function(){return this.node.attrs[xt]},set:function(t){this.updateAttrs(Object(dt["a"])({},xt,t))}}),t),template:"\n        <a\n          :class=\"{'is-highlighted': isHighlighted}\"\n          :".concat(xt,'="').concat(Tt,'"\n          :').concat(wt,'="').concat(Ct,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),r}(le["f"]);function ke(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function je(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(r),!0).forEach((function(e){Object(dt["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var _e={name:"CsEditor",components:{EditorContent:le["b"],EditorMenuBar:le["c"],EditorMenuBubble:le["d"]},data:function(){return{contentPlaceholder:"Můžete začít psát...",editor:void 0,keepInBounds:!0}},computed:je({},Object(A["c"])({editable:function(t){return t.editable},highlightedLatLng:function(t){return t.highlightedLatLng}}),{storyName:{get:function(){return this.$store.state.story.name},set:function(t){this.$store.commit(q,t)}}}),watch:{highlightedLatLng:function(){this.scrollToHighlightedLatLng()}},mounted:function(){this.editor=this.$createEditor()},methods:{scrollToHighlightedLatLng:function(){var t=this.highlightedLatLng,e=t.lat,r=t.lng,n=document.querySelector("[".concat(wt,"='").concat(e,"'], [").concat(xt,"='").concat(r,"']"));this.$scrollTo(n,void 0,{container:document.querySelector(".editor"),offset:-50})},isNewFeatureMarkButtonVisible:function(t){return t&&t[wt]},handleAddFeatureMarkClick:function(t){this.$emit(Nt,t)},$createEditor:function(){return new le["a"]({editable:this.editable,extensions:[new Oe,new ue["a"]({levels:[2,3,4]})],content:this.$store.state.story.text||this.contentPlaceholder,onUpdate:function(t){this.$store.commit(Y,t)}.bind(this)})}},beforeDestroy:function(){this.editor.destroy()}},Le=_e,Ee=(r("116c"),Object(tt["a"])(Le,ce,se,!1,null,null,null)),Se=Ee.exports,we=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cs-map"},[r("div",{attrs:{id:"cs-map-container"}},[r("l-map",{ref:"csmap",attrs:{center:t.highlightedLatLng||t.mapOptions.center,zoom:t.mapOptions.zoom},on:{click:function(e){return t.handleMapClick(e.latlng)}}},[r("l-control",{staticClass:"leaflet-bar leaflet-control",attrs:{position:"topleft"}},[t.editable?r("cs-track-upload-button",{on:t._d({},[t.TRACK_FILE_UPLOAD_EVENT,function(e){return t.handleFileUpload(e)}])}):t._e()],1),r("l-tile-layer",{attrs:{url:t.mapOptions.baseLayer}}),r("l-tile-layer",{attrs:{url:t.mapOptions.hikingOverlay,"layer-type":"overlay",opacity:.7}}),r("l-tile-layer",{attrs:{url:t.mapOptions.labelsOverlay,"layer-type":"overlay"}}),t.track?r("l-geo-json",{ref:"cstrack",attrs:{geojson:t.track,options:t.trackOptions.style.plain},on:{ready:function(e){return t.handleTrackReady(e)}}}):t._e(),t._l(t.featuresWithoutHighlighted,(function(e){return r("l-circle-marker",{attrs:{color:t.markerOptions.style.plain.color,"fill-color":t.markerOptions.style.plain.color,"fill-opacity":t.markerOptions.style.plain.fillOpacity,latLng:e,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}})})),t.highlightedLatLng?r("l-circle-marker",{attrs:{color:t.markerOptions.style.highlighted.color,"fill-color":t.markerOptions.style.highlighted.color,"fill-opacity":t.markerOptions.style.highlighted.fillOpacity,latLng:t.highlightedLatLng,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}}):t._e()],2)],1)])},xe=[],Ce=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("file-reader",{staticStyle:{height:"30px",width:"30px","line-height":"30px"},attrs:{accept:".json",output:"text"},on:{"reader-load":t.handleFileUpload},scopedSlots:t._u([{key:"reader",fn:function(e){return[r("el-button",{staticClass:"file-upload-button",attrs:{title:"Nahrát soubor trasy",size:"mini",type:"plain",icon:"el-icon-upload"},on:{click:function(e){return t.$refs.fileReader.click()}}}),r("input",{ref:"fileReader",staticStyle:{visibility:"hidden"},attrs:{type:"file",accept:e.accept},on:{change:e.onchange}})]}}])})},Te=[],Ae=r("5112"),Ne=r.n(Ae),Pe={name:"CsTrackUploadButton",components:{FileReader:Ne.a},methods:{handleFileUpload:function(t){try{this.$emit(Pt,t&&JSON.parse(t.data))}catch(e){this.$store.commit(z,{title:"Selhalo nahrání trasy",message:"Trasu se nepodařilo nahrát. Soubor pravděpodobně není validní."})}}}},$e=Pe,Me=(r("87e3"),Object(tt["a"])($e,Ce,Te,!1,null,null,null)),De=Me.exports;function Re(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ue(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Re(Object(r),!0).forEach((function(e){Object(dt["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}r("6cc5");var Fe={name:"CsMap",components:{CsTrackUploadButton:De,LCircleMarker:Xt["a"],LControl:Qt["a"],LGeoJson:te["a"],LMap:ee["a"],LTileLayer:re["a"],LRectangle:ne["a"]},data:function(){return{STORY_LINK_CLICK_EVENT:At,TRACK_FILE_UPLOAD_EVENT:Pt,addFeatureMark:void 0,markerOptions:oe,mapOptions:ae,trackOptions:ie}},computed:Ue({},Object(A["c"])({editable:function(t){return t.editable},highlightedLatLng:function(t){return t.highlightedLatLng},track:function(t){return t.story.track}}),{},Object(A["b"])(["features","featuresWithoutHighlighted"])),methods:{handleTrackReady:function(t){this.$refs.csmap.mapObject.fitBounds(t.getBounds())},handleFeatureClick:function(t){var e,r=t.latlng,n=r.lat,a=r.lng,o=document.querySelector("[data-cs-lat='".concat(n,"'], [data-cs-lng='").concat(a,"']"));o&&this.$store.commit(H,(e={},Object(dt["a"])(e,wt,o.getAttribute([wt])),Object(dt["a"])(e,xt,o.getAttribute([xt])),e))},handleMapClick:function(t){var e,r=this.$store.state.addFeatureMarkCallback;r&&"function"===typeof r&&(r((e={},Object(dt["a"])(e,wt,t.lat),Object(dt["a"])(e,xt,t.lng),e)),this.$store.commit(V,void 0))},handleFileUpload:function(t){this.$store.commit(Z,t)}}},Ie=Fe,ze=Object(tt["a"])(Ie,we,xe,!1,null,null,null),Be=ze.exports;r("6cc5");var Ve={name:"story-screen",components:{CsEditor:Se,LCircleMarker:Xt["a"],LControl:Qt["a"],LGeoJson:te["a"],LMap:ee["a"],LTileLayer:re["a"],LRectangle:ne["a"],CsMap:Be},data:function(){return{storyName:void 0,ready:!1,ADD_FEATURE_MARK_EVENT:Nt,STORY_LINK_CLICK_EVENT:At,TRACK_FILE_UPLOAD_EVENT:Pt,features:[],track:void 0,trackBounds:void 0,addFeatureMark:void 0,markerOptions:oe,mapOptions:ae,trackOptions:ie}},computed:{editable:function(){return this.$store.state.editable}},mounted:function(){this.ready="/story/create"===this.$router.currentRoute.path},methods:{handleAddFeatureMarkClick:function(t){this.$store.commit(V,t)},handleSave:function(){var t={name:this.$store.state.story.name,text:this.$store.state.story.text,track:this.$store.state.story.track};console.log("handleSave",t)}}},He=Ve,Je=(r("294c2"),Object(tt["a"])(He,Wt,Zt,!1,null,null,null)),Ke=Je.exports;T["default"].use(ct["a"]);var Ge=[{path:"/",component:Yt},{path:"/story/read/:title",component:Ke,beforeEnter:function(t,e,r){Vt.commit(B,!1),Vt.state.storyUrl?r():r("/story/load")}},{path:"/story/load",component:vt},{path:"/story/create",component:Ke,beforeEnter:function(t,e,r){Vt.commit(B,!0),r()}}],qe=new ct["a"]({mode:"history",base:"/cartostory-frontend/",routes:Ge});qe.beforeEach((function(t,e,r){Vt.commit(J,!0),r()})),qe.afterEach((function(){Vt.commit(J,!1)}));var Ye=qe;T["default"].config.productionTip=!1,T["default"].use(C.a),T["default"].use(w.a),T["default"].use(E.a),T["default"].use(j.a),T["default"].use(O.a),T["default"].use(g.a),T["default"].use(m.a),T["default"].use(h.a.directive),T["default"].use(f.a),T["default"].use(u.a),T["default"].use(s.a),T["default"].use(i.a),T["default"].use(P.a),T["default"].use(M.a),T["default"].use(A["a"]),T["default"].prototype.$notify=a.a,new T["default"]({store:Vt,router:Ye,render:function(t){return t(it)}}).$mount("#cartostory")},"5c0b":function(t,e,r){"use strict";var n=r("e332"),a=r.n(n);a.a},"6a5e":function(t,e,r){"use strict";var n=r("d1ab"),a=r.n(n);a.a},"6a99":function(t,e,r){},8271:function(t,e,r){},"87e3":function(t,e,r){"use strict";var n=r("0f74"),a=r.n(n);a.a},"9e12":function(t,e,r){},a2f0:function(t,e,r){},d1ab:function(t,e,r){},e332:function(t,e,r){},ee88:function(t,e,r){"use strict";var n=r("8271"),a=r.n(n);a.a}});
//# sourceMappingURL=app.fd8340b7.js.map