(function(t){function e(e){for(var r,o,s=e[0],c=e[1],l=e[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={app:0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"116c":function(t,e,n){"use strict";var r=n("9e12"),a=n.n(r);a.a},"2dd0":function(t,e,n){"use strict";var r=n("c6d2"),a=n.n(r);a.a},"33f4":function(t,e,n){},"3fab":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("289d"),a=n("a026"),i=n("2f62"),o=n("85ff"),s=n.n(o),c=n("f13c"),l=n.n(c),u=(n("f5df"),n("a41b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section",attrs:{id:"js-app"}},[n("router-view"),n("cs-notification"),n("b-loading",{attrs:{"is-full-page":!0,active:t.loading},on:{"update:active":function(e){t.loading=e}}})],1)}),d=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},b=[],f=(n("ac6a"),"REMOVE_ERROR"),p="UPDATE_BBOX_BEING_ADDED",m="UPDATE_ERRORS",g="UPDATE_EDITABLE",v="UPDATE_FEATURE_BEING_ADDED",y="UPDATE_HIGHLIGHTED_BBOX",O="UPDATE_HIGHLIGHTED_LAT_LNG",j="UPDATE_LOADING",k="UPDATE_MAP_CENTER",_="UPDATE_SHOULD_TEXT_SCROLL",x="UPDATE_STORY",C="UPDATE_STORY_NAME",w="UPDATE_STORY_TEXT",E="UPDATE_STORY_URL",S="UPDATE_TRACK",A={name:"CsNotification",computed:{errors:function(){var t=this;return this.$store.state.errors.forEach((function(e){t.$buefy.snackbar.open({indefinite:!0,position:"is-top-right",type:"is-danger",message:"<strong>".concat(e.title,"</strong><br/><p>").concat(e.message,"</p>"),onAction:function(){t.$store.commit(f,e)}}),t.$store.commit(f,e)})),this.$store.state.errors}},watch:{errors:function(){return this.errors}}},$=A,L=n("2877"),M=Object(L["a"])($,h,b,!1,null,null,null),D=M.exports,B={name:"app",components:{CsNotification:D},computed:{loading:function(){return this.$store.state.loading}}},P=B,T=Object(L["a"])(P,u,d,!1,null,null,null),N=T.exports,R=n("8c4f"),U=n("768b"),z=(n("96cf"),n("3b8d")),I=n("bd86"),F=(n("c5f6"),n("5df2"),n("75fc")),H=(n("20d6"),n("bc3a")),V=n.n(H),J=n("89c7"),G=n.n(J),q=n("c2d0"),X=n("7e8c"),K=(n("28a5"),"data-cs-bbox"),Y=at(K),Z="data-cs-lat",W="data-cs-lng",Q=at(Z),tt=at(W),et="mark-click",nt="save",rt="track-file-upload";function at(t){return t.split("-").map((function(t,e){return e>0?t.slice(0,1).toUpperCase()+t.slice(1):t})).join("")}var it,ot=function(t){return t[t.length-1]},st=function(t){return function(e,n){e[t]=n}},ct=function(t){return function(e,n){var r=t.slice(0,-1).reduce((function(e,n,r){return n in e||(e[n]="number"===typeof t[r+1]?[]:{}),e[n]}),e);r[ot(t)]=n}};a["a"].use(i["a"]);var lt={editable:!1,errors:[],bboxBeingAdded:{active:!1,bounds:void 0},featureBeingAdded:{active:!1,position:void 0},loading:!1,storyUrl:void 0,story:{name:void 0,text:void 0,track:void 0},availableStories:[],highlightedBbox:void 0,highlightedLatLng:void 0,shouldTextScroll:void 0},ut=(it={},Object(I["a"])(it,f,(function(t,e){var n=t.errors.findIndex((function(t){return t.title===e.title&&t.message===e.message}));n>-1&&t.errors.splice(n,1)})),Object(I["a"])(it,p,st("bboxBeingAdded")),Object(I["a"])(it,v,st("featureBeingAdded")),Object(I["a"])(it,g,st("editable")),Object(I["a"])(it,m,(function(t,e){t.errors=[].concat(Object(F["a"])(t.errors),[e])})),Object(I["a"])(it,y,(function(t,e){var n;e&&(n=[{lat:e[0][0],lng:e[0][1]},{lat:e[1][0],lng:e[1][1]}]),t.highlightedBbox=n})),Object(I["a"])(it,O,(function(t,e){t.highlightedLatLng=e?{lat:Number.parseFloat(e[Z]),lng:Number.parseFloat(e[W])}:void 0})),Object(I["a"])(it,j,st("loading")),Object(I["a"])(it,k,ct(["map","center"])),Object(I["a"])(it,_,st("shouldTextScroll")),Object(I["a"])(it,x,st("story")),Object(I["a"])(it,C,ct(["story","name"])),Object(I["a"])(it,w,ct(["story","text"])),Object(I["a"])(it,E,st("storyUrl")),Object(I["a"])(it,S,ct(["story","track"])),it),dt={updateTrack:function(t,e){var n=t.commit;n(S,e)},updateStoryText:function(t,e){var n=t.commit;n(w,e)},loadStory:function(){var t=Object(z["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,r=e.state,n(j,!0),t.next=4,V.a.get(r.storyUrl);case 4:a=t.sent,n(x,a.data);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},ht={content:function(t){var e;return e=t.story.text&&t.story.text.state?t.story.text.state.doc.content:t.story.text&&t.story.text.content,e&&JSON.parse(JSON.stringify(e))},bboxes:function(t,e){var n=[],r=e.content;if(r){var a=Object(X["a"])(r,K);n=Object(q["a"])(a,(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t})).map((function(t){return JSON.parse(t)})).map((function(e,n){var r=Object(U["a"])(e,2),a=r[0],i=r[1],o=!1;if(t.highlightedBbox){var s=t.highlightedBbox[0],c=s.lat,l=s.lng,u=t.highlightedBbox[1],d=u.lat,h=u.lng,b=[c,l,d,h];o=[].concat(Object(F["a"])(a),Object(F["a"])(i)).every((function(t,e){return t===b[e]}))}return{id:"bbox-".concat(n),bounds:[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],highlighted:o}}))}return n},features:function(t,e){var n=[],r=e.content;if(r){var a=Object(q["a"])(Object(X["a"])(r,[Z,W]),(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t}));n=G()(a,2).map((function(e){var n=t.highlightedLatLng&&t.highlightedLatLng.lat,r=t.highlightedLatLng&&t.highlightedLatLng.lng;return{lat:e[0],lng:e[1],highlighted:e[0]===n&&e[1]===r}}))}return n}},bt=new i["a"].Store({strict:!0,getters:ht,state:lt,mutations:ut,actions:dt}),ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"hero is-fullheight"},[n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[t._m(0),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 section-left has-pb-0"},[n("h2",{staticClass:"title is-2 has-text-weight-normal has-text-centered has-mb-2"},[t._v("Napsat příběh")]),n("p",[t._v("Chcete napsat svůj vlastní příběh? Z prázdnin, dovolené nebo jen zajímavého sobotního\n                výletu?")]),n("b-button",{on:{click:function(e){return t.$router.push("/story/create")}}},[t._v("Chci psát")])],1),n("div",{staticClass:"column is-6 section-right has-pb-0"},[n("h2",{staticClass:"title is-2 has-text-weight-normal has-text-centered has-mb-2"},[t._v("Číst příběh")]),n("p",[t._v("Váš kamarád nebo příbuzný napsal příběh a poslal vám jeho adresu? Můžete si ho přečíst.")]),n("b-button",{on:{click:function(e){return t.$router.push("/story/load")}}},[t._v("Chci číst")])],1)])])])])])])},pt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mb-1"},[t._v("Cartostory")])])])}],mt={name:"Landing"},gt=mt,vt=(n("6a2b"),Object(L["a"])(gt,ft,pt,!1,null,"40225d4e",null)),yt=vt.exports,Ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid story-form"},[n("div",{staticClass:"columns has-margin-0",staticStyle:{height:"100vh"}},[n("cs-map"),n("div",{staticStyle:{display:"flex","flex-direction":"column",width:"100%"}},[t.$store.state.story.text||t.ready?n("cs-editor"):t._e()],1)],1)])},jt=[],kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-12 has-padding-0 story-text"},[n("div",{staticClass:"story-text__content"},[t.editable?n("form",{staticClass:"has-mt-1"},[n("b-field",[n("b-input",{attrs:{"custom-class":"story-title-input",placeholder:"Název příběhu",size:"is-large"},model:{value:t.storyName,callback:function(e){t.storyName=e},expression:"storyName"}})],1)],1):t._e(),t.editable?t._e():n("h1",{staticClass:"story-title-input has-mt-1"},[t._v(t._s(t.storyName))]),t.editable?n("menu-bar",{attrs:{editor:t.editor},on:t._d({},[t.SAVE_EVENT,t.handleSave])}):t._e(),t.editable?n("menu-bubble",{attrs:{editor:t.editor},on:{changed:t.handleContentUpdate},nativeOn:{click:function(e){return t.handleContentUpdate(e)}}}):t._e(),n("editor-content",{staticClass:"editor has-mt-1 has-mb-1",class:{editable:this.editable},staticStyle:{flex:"1",overflow:"auto"},attrs:{editor:t.editor}})],1)])},_t=[],xt=(n("8e6e"),n("456d"),n("7f7f"),n("cd3f")),Ct=n.n(xt),wt=n("cd42"),Et=n("f23d"),St=(n("6b54"),n("2397"),n("d225")),At=n("b0b4"),$t=n("308d"),Lt=n("6bb5"),Mt=n("4e2b"),Dt=n("a9de");function Bt(t){var e;return e="lat"in t[0]?"[[".concat(t[0].lat,",").concat(t[0].lng,"],[").concat(t[1].lat,",").concat(t[1].lng,"]]"):"[[".concat(t[0][0],",").concat(t[0][1],"],[").concat(t[1][0],",").concat(t[1][1],"]]"),e}function Pt(t){return"[".concat(K,"='").concat(Bt(t),"']")}function Tt(t){var e;return e="lat"in t?"[".concat(Z,"='").concat(t.lat,"'], [").concat(W,"='").concat(t.lng,"']"):"[".concat(Z,"='").concat(t[0],"'], [").concat(W,"='").concat(t[1],"']"),e}function Nt(t){return function(){var e,n=Object(Lt["a"])(t);if(Rt()){var r=Object(Lt["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object($t["a"])(this,e)}}function Rt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ut="a",zt=function(t){Object(Mt["a"])(n,t);var e=Nt(n);function n(){return Object(St["a"])(this,n),e.apply(this,arguments)}return Object(At["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]];return Object(Dt["a"])(e,Object(I["a"])({},K,JSON.stringify(n)))}}},{key:"name",get:function(){return"bboxMark"}},{key:"schema",get:function(){return{attrs:Object(I["a"])({},K,{default:null}),parseDOM:[{tag:Ut,getAttrs:function(t){return Object(I["a"])({},K,t.dataset[K])}}],toDOM:function(t){return[Ut,Object(I["a"])({},K,t.attrs[K]),0]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t=JSON.parse(this[Y]);this.$store.commit(O,void 0),this.$store.commit(y,t)}},computed:Object(I["a"])({isHighlighted:function(){if(!this.$store.state.highlightedBbox)return!1;var t=this[Y],e=Bt(this.$store.state.highlightedBbox);return e===t}},Y,{get:function(){return this.node.attrs[K]},set:function(t){this.updateAttrs(Object(I["a"])({},K,t))}}),template:'\n        <a\n          title="Kliknutím vycentrujete mapu"\n          :class="{\'is-highlighted\': isHighlighted}"\n          :'.concat(K,'="').concat(Y,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(wt["f"]);function It(t){return function(){var e,n=Object(Lt["a"])(t);if(Ft()){var r=Object(Lt["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object($t["a"])(this,e)}}function Ft(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Ht="a",Vt=function(t){Object(Mt["a"])(n,t);var e=It(n);function n(){return Object(St["a"])(this,n),e.apply(this,arguments)}return Object(At["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n;return Object(Dt["a"])(e,(n={},Object(I["a"])(n,Z,t&&t[Z]),Object(I["a"])(n,W,t&&t[W]),n))}}},{key:"name",get:function(){return"featureMark"}},{key:"schema",get:function(){var t;return{attrs:(t={},Object(I["a"])(t,Z,{default:null}),Object(I["a"])(t,W,{default:null}),t),parseDOM:[{tag:Ht,getAttrs:function(t){var e;return e={},Object(I["a"])(e,Z,t.dataset[Z]),Object(I["a"])(e,W,t.dataset[W]),e}}],toDOM:function(t){var e;return[Ht,(e={},Object(I["a"])(e,Z,t.attrs[Z]),Object(I["a"])(e,W,t.attrs[W]),e),0]}}}},{key:"view",get:function(){var t;return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t,e=(t={},Object(I["a"])(t,Z,this[Q]),Object(I["a"])(t,W,this[tt]),t);this.$store.commit(_,!1),this.$store.commit(y,void 0),this.$store.commit(O,e)}},computed:(t={isHighlighted:function(){if(!this.$store.state.highlightedLatLng)return!1;var t=this.$store.state.highlightedLatLng,e=t.lat,n=t.lng;return e===this[Q]&&n===this[tt]}},Object(I["a"])(t,Q,{get:function(){return this.node.attrs[Z]},set:function(t){this.updateAttrs(Object(I["a"])({},Z,t))}}),Object(I["a"])(t,tt,{get:function(){return this.node.attrs[W]},set:function(t){this.updateAttrs(Object(I["a"])({},W,t))}}),t),template:'\n        <a\n          title="Kliknutím vycentrujete mapu"\n          :class="{\'is-highlighted\': isHighlighted}"\n          :'.concat(W,'="').concat(tt,'"\n          :').concat(Z,'="').concat(Q,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(wt["f"]),Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bar",{staticClass:"has-mt-1",staticStyle:{background:"white"},attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.isActive;return[n("div",{staticClass:"editor-menu-bar buttons"},[n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:2})},attrs:{title:"Nadpis 1. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:2})}}},[t._v("\n      H1\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:3})},attrs:{title:"Nadpis 2. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:3})}}},[t._v("\n      H2\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:4})},attrs:{title:"Nadpis 3. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:4})}}},[t._v("\n      H3\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.image()},attrs:{title:"Obrázek",size:"is-small"},on:{click:function(e){return t.showImagePrompt(r.image)}}},[n("b-icon",{attrs:{size:"is-small",icon:"image-filter-hdr","custom-class":"image-icon"}})],1),n("b-button",{staticClass:"menubar__button",staticStyle:{"margin-left":"auto"},attrs:{size:"is-small",type:"is-primary"},on:{click:t.handleSave}},[t._v("Uložit\n    ")])],1)]}}])})},Gt=[],qt={name:"MenuBar",components:{EditorMenuBar:wt["c"]},props:["editor"],methods:{showImagePrompt:function(t){var e=prompt("Enter the url of your image here");e&&t({src:e})},handleSave:function(){this.$emit(nt)}}},Xt=qt,Kt=Object(L["a"])(Xt,Jt,Gt,!1,null,"e6ea042a",null),Yt=Kt.exports,Zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":!0},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.getMarkAttrs,i=e.isActive,o=e.menu;return[n("div",{staticClass:"menububble",class:{"is-active":o.isActive},style:"left: "+o.left+"px; bottom: "+o.bottom+"px;"},[t.isNewFeatureMarkButtonVisible(a("featureMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__mark",class:{"is-active":i.featureMark()},attrs:{"icon-left":"map-marker-plus"},on:{click:function(e){return t.handleAddFeatureMarkClick(r.featureMark)}}}),t.isNewFeatureMarkButtonVisible(a("featureMark"))?n("b-button",{staticClass:"menububble__button",class:{"is-active":i.featureMark()},attrs:{"icon-left":"map-marker-minus"},on:{click:function(e){return t.handleRemoveFeatureMarkClick(r.featureMark)}}}):t._e(),t.isNewBboxMarkVisible(a("bboxMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":i.bboxMark()},attrs:{"icon-left":"fullscreen"},on:{click:function(e){return t.handleAddBoundingBoxClick(r.bboxMark)}}}),t.isNewBboxMarkVisible(a("bboxMark"))?n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":i.bboxMark()},attrs:{"icon-left":"fullscreen-exit"},on:{click:function(t){return r.bboxMark()}}}):t._e()],1)]}}])})},Wt=[];function Qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qt(Object(n),!0).forEach((function(e){Object(I["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ee={data:function(){return{bboxAddedCallback:void 0,featureMarkAddedCallback:void 0}},name:"MenuBubble",props:["editor"],components:{EditorMenuBubble:wt["d"]},computed:te({},Object(i["c"])({bboxBeingAdded:function(t){return t.bboxBeingAdded},featureBeingAdded:function(t){return t.featureBeingAdded}})),watch:{bboxBeingAdded:function(t){t&&t.active&&t.bounds&&this.bboxAddedCallback&&(this.bboxAddedCallback(t.bounds),this.bboxAddedCallback=void 0,this.$store.commit(p,{active:!1,position:void 0}),this.$emit("changed"))},featureBeingAdded:function(t){t&&t.active&&t.position&&this.featureMarkAddedCallback&&(this.featureMarkAddedCallback(t.position),this.featureMarkAddedCallback=void 0,this.$store.commit(v,{active:!1,position:void 0}),this.$emit("changed"))}},methods:{isNewFeatureMarkButtonVisible:function(t){return t&&t[Z]},isNewBboxMarkVisible:function(t){return t&&t[K]},handleAddFeatureMarkClick:function(t){this.featureMarkAddedCallback=t,this.$store.commit(v,{active:!0,position:void 0})},handleRemoveFeatureMarkClick:function(t){this.$store.commit(O,void 0),t()},handleAddBoundingBoxClick:function(t){this.bboxAddedCallback=t,this.$store.commit(p,{active:!0,bounds:void 0})}}},ne=ee,re=(n("b7dd"),Object(L["a"])(ne,Zt,Wt,!1,null,"620f66f7",null)),ae=re.exports,ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section"},[n("div",{staticClass:"container"},[t._m(0),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"has-padding-1",domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})])])},oe=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns has-mb-0"},[n("div",{staticClass:"column has-pb-0"},[n("div",{staticClass:"notification"},[n("h1",{staticClass:"title is-1 has-text-centered"},[t._v("Uložení příběhu")]),n("p",[t._v("Zatím to jinak neumíme, proto si prosím celý příběh zkopírujte a uložte někam, odkud\n            ho budete moct později načíst (např. na "),n("a",{attrs:{href:"https://github.com"}},[t._v("GitHub")]),t._v(").")])])])])}],se={name:"CsStoryJson",props:{content:{required:!0,type:String}}},ce=se,le=(n("2dd0"),Object(L["a"])(ce,ie,oe,!1,null,"152c0c6a",null)),ue=le.exports;function de(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?de(Object(n),!0).forEach((function(e){Object(I["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var be=Object(I["a"])({name:"CsEditor",components:{EditorContent:wt["b"],MenuBubble:ae,MenuBar:Yt},data:function(){return{content:"Můžete začít psát...",editor:void 0,keepInBounds:!0,SAVE_EVENT:nt}},computed:he({},Object(i["c"])(["editable","highlightedBbox","highlightedLatLng","shouldTextScroll"]),{},Object(i["c"])({text:function(t){return t.story.text},track:function(t){return t.story.track}}),{storyName:{get:function(){return this.$store.state.story.name},set:function(t){this.$store.commit(C,t)}}}),watch:{highlightedLatLng:function(t){t&&this.scrollToHighlighted()},highlightedBbox:function(t){t&&this.scrollToHighlighted()}},beforeMount:function(){document.documentElement.classList.add("is-clipped")},beforeDestroy:function(){document.documentElement.classList.remove("is-clipped")},mounted:function(){this.editor=this.$createEditor(),this.text&&this.editor.setContent(this.text)},methods:{handleContentUpdate:function(){this.$store.commit(w,Ct()(this.editor.getJSON()))},handleSave:function(){this.handleContentUpdate();var t={name:this.storyName,text:this.text,track:this.track},e=JSON.stringify(t);this.$buefy.modal.open({component:ue,parent:this,customClass:"modal-result",props:{content:e}})},scrollToHighlighted:function(){var t=this.$getHighlightedNode();t&&this.$scrollTo(t,void 0,{container:document.querySelector(".editor"),offset:-50})},$getHighlightedNode:function(){var t;if(this.shouldTextScroll)return this.highlightedLatLng&&(t=Tt(this.highlightedLatLng)),this.highlightedBbox&&(t=Pt(this.highlightedBbox)),document.querySelector(t)},$createEditor:function(){return new wt["a"]({editable:this.editable,extensions:[new zt,new Vt,new Et["a"]({levels:[2,3,4]}),new Et["b"]],content:this.content})}}},"beforeDestroy",(function(){this.editor.destroy()})),fe=be,pe=(n("116c"),Object(L["a"])(fe,kt,_t,!1,null,null,null)),me=pe.exports,ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-6 has-padding-0"},[n("div",{staticClass:"cs-map"},[n("div",{attrs:{id:"cs-map-container"}},[n("l-map",{ref:"csmap",attrs:{bounds:t.mapBounds,center:t.mapCenter,zoom:t.mapOptions.zoom},on:{click:function(e){return t.handleMapClick(e.latlng)},mousedown:function(e){return t.handleMapMouseDown(e.latlng)}}},[n("l-control",{staticClass:"leaflet-bar leaflet-control",attrs:{position:"topleft"}},[t.editable?n("cs-track-upload-button",{on:t._d({},[t.TRACK_FILE_UPLOAD_EVENT,function(e){return t.handleFileUpload(e)}])}):t._e()],1),n("l-tile-layer",{attrs:{url:t.mapOptions.baseLayer}}),n("l-tile-layer",{attrs:{url:t.mapOptions.hikingOverlay,"layer-type":"overlay",opacity:.4}}),n("l-tile-layer",{attrs:{url:t.mapOptions.labelsOverlay,"layer-type":"overlay"}}),t.track?n("l-geo-json",{ref:"cstrack",attrs:{geojson:t.track,options:t.trackOptions.style.plain},on:{ready:function(e){return t.handleTrackReady(e)}}}):t._e(),t._l(t.bboxes,(function(e){return n("l-rectangle",{key:e.id,attrs:{bounds:e.bounds,"l-style":e.highlighted?t.bboxOptions.selected.style:t.bboxOptions.plain.style},on:{click:function(n){return t.handleBboxClick(n,e)}}})})),t._l(t.features,(function(e,r){return n("l-circle-marker",{key:r,attrs:{color:e.highlighted?t.markerOptions.style.highlighted.color:t.markerOptions.style.plain.color,"fill-color":e.highlighted?t.markerOptions.style.highlighted.color:t.markerOptions.style.plain.color,"fill-opacity":e.highlighted?t.markerOptions.style.highlighted.fillOpacity:t.markerOptions.style.plain.fillOpacity,latLng:e,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}})}))],2)],1)])])},ve=[],ye=n("ea97"),Oe=n("2253c"),je=n("044a"),ke=n("2699"),_e=n("a40a"),xe=n("fb8e"),Ce={bounds:void 0,center:[50,19],baseLayer:"https://api.mapbox.com/styles/v1/cartostory/cjugqcypf27581gnry4y59lxy/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",hikingOverlay:"http://tile.mtbmap.cz/overlay_hiking/{z}/{x}/{y}.png",labelsOverlay:"https://api.mapbox.com/styles/v1/cartostory/cjugqfe8r1lhh1ftgrmr7v9zj/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",zoom:8,edgeMarker:void 0},we={style:{common:{radius:8,weight:1.5},highlighted:{color:"#F56C6C",opacity:1,fillOpacity:.4},inBbox:{color:"#42b983",fillOpacity:.5},plain:{color:"#3185fc",fillOpacity:.5},edge:{icon:{iconUrl:"../../node_modules/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]}}}},Ee={plain:{style:{color:"#5a5a66",fillOpacity:0,dashArray:"5",weight:2}},hovered:{style:{color:"#5a5a66",fillColor:"#5a5a66",dashArray:"5",weight:2}},selected:{style:{color:"#42b983",fillColor:"#42b983",fillOpacity:0,dashArray:"5",weight:2}}},Se={style:{plain:{color:"#5a5a66",dashArray:"6"},inBbox:{color:"#42b983",dashArray:"6"}}},Ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("file-reader",{staticStyle:{height:"30px",width:"30px","line-height":"30px"},attrs:{accept:".json",output:"text"},on:{"reader-load":t.handleFileUpload},scopedSlots:t._u([{key:"reader",fn:function(e){return[n("b-button",{staticClass:"file-upload-button",attrs:{title:"Nahrát soubor trasy",size:"is-small","icon-left":"cloud-upload"},on:{click:function(e){return t.$refs.fileReader.click()}}}),n("input",{ref:"fileReader",staticStyle:{visibility:"hidden"},attrs:{type:"file",accept:e.accept},on:{change:e.onchange}})]}}])})},$e=[],Le=n("5112"),Me=n.n(Le),De={name:"CsTrackUploadButton",components:{FileReader:Me.a},methods:{handleFileUpload:function(t){try{this.$emit(rt,t&&JSON.parse(t.data))}catch(e){this.$store.commit(m,{title:"Selhalo nahrání trasy",message:"Trasu se nepodařilo nahrát. Soubor pravděpodobně není validní."})}}}},Be=De,Pe=(n("d51c"),Object(L["a"])(Be,Ae,$e,!1,null,"6f11a710",null)),Te=Pe.exports;function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){Object(I["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n("6cc5"),n("20d6b");var Ue={name:"CsMap",components:{CsTrackUploadButton:Te,LCircleMarker:ye["a"],LControl:Oe["a"],LGeoJson:je["a"],LMap:ke["a"],LTileLayer:_e["a"],LRectangle:xe["a"]},data:function(){return{STORY_LINK_CLICK_EVENT:et,TRACK_FILE_UPLOAD_EVENT:rt,bboxOptions:Ee,drawControl:void 0,markerOptions:we,mapOptions:Ce,trackOptions:Se}},computed:Re({mapBounds:function(){var t=this.highlightedBbox;if(this.recenterMap&&t)return window.L.latLngBounds(t)},mapCenter:function(){var t=this.mapBounds&&this.mapBounds.getCenter(),e=this.$refs.csmap&&this.$refs.csmap.mapObject.getCenter(),n=this.recenterMap&&this.highlightedLatLng;return t||n||e}},Object(i["b"])(["bboxes","features","featuresWithoutHighlighted"]),{},Object(i["c"])(["bboxBeingAdded","editable","featureBeingAdded","highlightedBbox","highlightedLatLng","shouldTextScroll"]),{},Object(i["c"])({recenterMap:function(t){return!t.shouldTextScroll},track:function(t){return t.story.track}})),methods:{handleTrackReady:function(t){this.$refs.csmap.mapObject.fitBounds(t.getBounds())},handleBboxClick:function(t,e){var n=Pt(e.bounds),r=document.querySelector(n);r&&(this.$store.commit(O,void 0),this.$store.commit(y,e.bounds),this.$store.commit(_,!0))},handleFeatureClick:function(t){var e,n=Tt(t.latlng),r=document.querySelector(n);r&&(this.$store.commit(O,(e={},Object(I["a"])(e,Z,r.getAttribute([Z])),Object(I["a"])(e,W,r.getAttribute([W])),e)),this.$store.commit(y,void 0),this.$store.commit(_,!0))},handleMapClick:function(t){var e;if(this.featureBeingAdded.active){var n=(e={},Object(I["a"])(e,Z,t.lat),Object(I["a"])(e,W,t.lng),e);this.$store.commit(v,{active:!0,position:n})}},handleMapMouseDown:function(){if(this.bboxBeingAdded.active){var t=this.$refs.csmap.mapObject;window.L.drawLocal.draw.handlers.rectangle.tooltip.start="",window.L.drawLocal.draw.handlers.simpleshape.tooltip.end="",new window.L.Draw.Rectangle(t,{showArea:!1,shapeOptions:this.bboxOptions.plain.style}).enable(),t.off(window.L.Draw.Event.CREATED),t.on(window.L.Draw.Event.CREATED,this.$handleCreateRectangle)}},handleFileUpload:function(t){this.$store.commit(S,t)},$handleCreateRectangle:function(t){var e=t.layer.getBounds(),n=e.getNorthWest(),r=e.getSouthEast(),a=[[n.lat,n.lng],[r.lat,r.lng]];this.$store.commit(p,{active:!0,bounds:a})}}},ze=Ue,Ie=(n("bafc"),Object(L["a"])(ze,ge,ve,!1,null,"0c9320d8",null)),Fe=Ie.exports,He={name:"story-screen",components:{CsEditor:me,CsMap:Fe},data:function(){return{ready:!1}},computed:{editable:function(){return this.$store.state.editable}},mounted:function(){this.ready="/story/create"===this.$router.currentRoute.path}},Ve=He,Je=Object(L["a"])(Ve,Ot,jt,!1,null,"945d406c",null),Ge=Je.exports,qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mt-2"},[t._v("Cartostory")]),n("div",{staticClass:"card has-padding-1"},[n("div",{staticClass:"card-content"},[t.availableStories.length>0?n("b-field",{attrs:{label:"Nahrát příběh"}},[n("b-select",{attrs:{placeholder:"Příběh",expanded:""},on:{input:t.handleStorySelect}},t._l(t.availableStories,(function(e){return n("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.name)+"\n            ")])})),0)],1):t._e(),n("b-field",{attrs:{label:"URL příběhu"}},[n("b-input",{attrs:{type:"text",expanded:""},model:{value:t.storyUrl,callback:function(e){t.storyUrl=e},expression:"storyUrl"}})],1),n("b-button",{attrs:{disabled:t.disabledSubmit,type:"is-primary"},on:{click:t.handleSubmit}},[t._v("Načíst")])],1)])])])])},Xe=[],Ke=(n("7514"),n("f788")),Ye=n.n(Ke);function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function We(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ze(Object(n),!0).forEach((function(e){Object(I["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qe={name:"LoadStoryForm",data:function(){return{currentStory:void 0}},computed:We({},Object(i["c"])({availableStories:function(t){return t.availableStories},storyName:function(t){return t.story.name},storyText:function(t){return t.story.text}}),{disabledSubmit:function(){return!this.storyUrl},storyUrl:{get:function(){return this.$store.state.storyUrl},set:function(t){this.$store.commit(E,t)}}}),methods:{handleSubmit:function(){var t=Object(z["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("loadStory");case 3:e=Ye()(this.storyName).toLowerCase(),this.$router.push("/story/read/".concat(e)),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$store.commit(m,{title:"Příběh se nepodařilo nahrát",message:"Zkontrolujte jeho adresu."});case 10:return t.prev=10,this.$store.commit(j,!1),t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,7,10,13]])})));function e(){return t.apply(this,arguments)}return e}(),handleStorySelect:function(t){var e=this.availableStories.find((function(e){return e.name===t}));e&&(this.storyUrl=e.storyUrl)}}},tn=Qe,en=Object(L["a"])(tn,qe,Xe,!1,null,"6706dcd3",null),nn=en.exports;a["a"].use(R["a"]);var rn=[{path:"/",component:yt},{path:"/story/read/:title",component:Ge,beforeEnter:function(t,e,n){bt.commit(g,!1),bt.state.storyUrl?n():n("/story/load")}},{path:"/story/load",component:nn},{path:"/story/create",component:Ge,beforeEnter:function(t,e,n){bt.commit(g,!0),n()}}],an=new R["a"]({mode:"history",base:"/",routes:rn});an.beforeEach((function(t,e,n){bt.commit(j,!0),n()})),an.afterEach((function(){bt.commit(j,!1)}));var on=an;n("6cc5"),a["a"].config.productionTip=!1,a["a"].use(r["a"]),a["a"].use(s.a),a["a"].use(l.a),a["a"].use(i["a"]),new a["a"]({store:bt,router:on,render:function(t){return t(N)}}).$mount("#js-cartostory")},6297:function(t,e,n){},"6a2b":function(t,e,n){"use strict";var r=n("33f4"),a=n.n(r);a.a},"9dc3":function(t,e,n){},"9e12":function(t,e,n){},a41b:function(t,e,n){},b7dd:function(t,e,n){"use strict";var r=n("3fab"),a=n.n(r);a.a},bafc:function(t,e,n){"use strict";var r=n("9dc3"),a=n.n(r);a.a},c6d2:function(t,e,n){},d51c:function(t,e,n){"use strict";var r=n("6297"),a=n.n(r);a.a}});
//# sourceMappingURL=app.cc739183.js.map