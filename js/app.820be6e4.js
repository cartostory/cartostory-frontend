(function(t){function e(e){for(var r,o,s=e[0],c=e[1],u=e[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={app:0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"116c":function(t,e,n){"use strict";var r=n("9e12"),a=n.n(r);a.a},"305c":function(t,e,n){},"3fab":function(t,e,n){},"421f":function(t,e,n){"use strict";var r=n("8ca6"),a=n.n(r);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("96cf");var r,a=n("3b8d"),i=(n("cadf"),n("551c"),n("f751"),n("097d"),n("289d")),o=n("a026"),s=n("2f62"),c=n("85ff"),u=n.n(c),l=n("f13c"),d=n.n(l),h=(n("f5df"),n("a41b"),"REMOVE_ERROR"),p="UPDATE_BBOX_BEING_ADDED",f="UPDATE_ERRORS",b="UPDATE_EDITABLE",m="UPDATE_FEATURE_BEING_ADDED",g="UPDATE_HIGHLIGHTED_BBOX",v="UPDATE_HIGHLIGHTED_LAT_LNG",y="UPDATE_LOADING",O="UPDATE_MAP_CENTER",k="UPDATE_SHOULD_TEXT_SCROLL",j="UPDATE_STORY",x="UPDATE_STORY_AUTHOR",_="UPDATE_STORY_NAME",w="UPDATE_STORY_TEXT",C="UPDATE_STORY_URL",$="UPDATE_TOKEN",S="UPDATE_TRACK",A=n("8160"),E=(n("386d"),n("6762"),n("2fdb"),n("a8db")),R=n("9767"),T=function(){return window.history.replaceState({},document.title,window.location.pathname)},P=function(){return r},L=function(t){var e=t.onRedirectCallback,n=void 0===e?T:e,i=t.redirectUri,s=void 0===i?"".concat(window.location.origin,"/login-callback"):i,c=Object(E["a"])(t,["onRedirectCallback","redirectUri"]);return r||(r=new o["a"]({data:function(){return{loading:!0,isAuthenticated:!1,user:{},auth0Client:null,popupOpen:!1,error:null}},methods:{loginWithPopup:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.popupOpen=!0,t.prev=1,t.next=4,this.auth0Client.loginWithPopup(e);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),console.error(t.t0);case 9:return t.prev=9,this.popupOpen=!1,t.finish(9);case 12:return t.next=14,this.auth0Client.getUser();case 14:this.user=t.sent,this.isAuthenticated=!0;case 16:case"end":return t.stop()}}),t,this,[[1,6,9,12]])})));function e(e){return t.apply(this,arguments)}return e}(),handleRedirectCallback:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,this.auth0Client.handleRedirectCallback();case 4:return t.next=6,this.auth0Client.getUser();case 6:this.user=t.sent,this.isAuthenticated=!0,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),this.error=t.t0;case 13:return t.prev=13,this.loading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[1,10,13,16]])})));function e(){return t.apply(this,arguments)}return e}(),loginWithRedirect:function(t){return this.auth0Client.loginWithRedirect(t)},getIdTokenClaims:function(t){return this.auth0Client.getIdTokenClaims(t)},getTokenSilently:function(t){return this.auth0Client.getTokenSilently(t)},getTokenWithPopup:function(t){return this.auth0Client.getTokenWithPopup(t)},logout:function(t){return this.auth0Client.logout(t)}},created:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(R["a"])({domain:c.domain,client_id:c.clientId,audience:c.audience,redirect_uri:s});case 2:if(this.auth0Client=t.sent,t.prev=3,!window.location.search.includes("code=")||!window.location.search.includes("state=")){t.next=10;break}return t.next=7,this.auth0Client.handleRedirectCallback();case 7:e=t.sent,r=e.appState,n(r);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](3),this.error=t.t0;case 15:return t.prev=15,t.next=18,this.auth0Client.isAuthenticated();case 18:return this.isAuthenticated=t.sent,t.next=21,this.auth0Client.getUser();case 21:return this.user=t.sent,this.loading=!1,t.finish(15);case 24:case"end":return t.stop()}}),t,this,[[3,12,15,24]])})));function e(){return t.apply(this,arguments)}return e}()}),r)},B={install:function(t,e){t.prototype.$auth=L(e)}},M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section",attrs:{id:"js-app"}},[n("cs-menu"),n("router-view"),n("cs-notification"),n("b-loading",{attrs:{"is-full-page":!0,active:t.loading},on:{"update:active":function(e){t.loading=e}}})],1)},D=[],U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-navbar",{attrs:{shadow:!0,transparent:!0}},[n("template",{slot:"brand"},[n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[n("strong",[t._v("Cartostory")])])],1),n("template",{slot:"start"},[n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/about"}}},[t._v("O projektu")]),t.$auth.isAuthenticated?n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/stories"}}},[t._v("Moje příběhy")]):t._e(),t.$auth.isAuthenticated?n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/story/create"}}},[t._v("Napsat příběh")]):t._e()],1),n("template",{slot:"end"},[n("b-navbar-item",{attrs:{tag:"div"}},[n("div",{staticClass:"buttons"},[t.$auth.isAuthenticated?t._e():n("b-button",{attrs:{type:"is-primary",tag:"router-link",to:"/login",outlined:""}},[t._v("Přihlásit")])],1)]),!t.$auth.loading&&t.$auth.isAuthenticated?n("b-navbar-dropdown",{attrs:{right:!0,arrowless:!0}},[n("template",{slot:"label"},[n("span",{staticClass:"has-text-grey-lighter"},[t._v(t._s(t.$auth.user.name))]),t.$auth.user.picture?n("figure",{staticClass:"has-pl-1 image"},[n("img",{staticClass:"is-rounded",attrs:{src:t.$auth.user.picture}})]):t._e()]),n("b-navbar-item",{attrs:{href:"#"}},[n("b-button",{attrs:{type:"is-text",outlined:""},on:{click:t.logout}},[t._v("Odhlásit")])],1)],2):t._e()],1)],2)},N=[],z={methods:{logout:function(){this.$auth.logout({returnTo:window.location.origin})}}},I=z,F=n("2877"),H=Object(F["a"])(I,U,N,!1,null,"af3f5e1c",null),J=H.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},V=[],W=(n("ac6a"),{name:"CsNotification",computed:{errors:function(){var t=this;return this.$store.state.errors.forEach((function(e){t.$buefy.snackbar.open({indefinite:!0,position:"is-top-right",type:"is-danger",message:"<strong>".concat(e.title,"</strong><br/><p>").concat(e.message,"</p>"),onAction:function(){t.$store.commit(h,e)}}),t.$store.commit(h,e)})),this.$store.state.errors}},watch:{errors:function(){return this.errors}}}),q=W,K=Object(F["a"])(q,G,V,!1,null,null,null),Y=K.exports,Z={name:"app",components:{CsMenu:J,CsNotification:Y},computed:{loading:function(){return this.$store.state.loading}}},X=Z,Q=Object(F["a"])(X,M,D,!1,null,null,null),tt=Q.exports,et=n("8c4f"),nt=n("768b"),rt=n("bd86"),at=(n("c5f6"),n("5df2"),n("75fc")),it=(n("20d6"),n("89c7")),ot=n.n(it),st=n("c2d0"),ct=n("7e8c"),ut=n("bc3a"),lt=n.n(ut),dt=lt.a.create();dt.defaults.baseURL="https://lih247zg28.execute-api.eu-west-1.amazonaws.com/prod",dt.defaults.headers.post["Content-Type"]="application/json",dt.defaults.headers.get["Content-Type"]="application/json",dt.defaults.headers.put["Content-Type"]="application/json";var ht=dt,pt=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.id,a=Object(E["a"])(e,["id"]),!r){t.next=7;break}return t.next=4,gt(r,a,n);case 4:i=t.sent,t.next=10;break;case 7:return t.next=9,bt(a,n);case 9:i=t.sent;case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ft=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht.get("/story/".concat(e),{headers:{Authorization:"Bearer ".concat(n)}});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function bt(t,e){return mt.apply(this,arguments)}function mt(){return mt=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht.post("/story",{story:e},{headers:{Authorization:"Bearer ".concat(n)}});case 2:return r=t.sent,t.abrupt("return",r.data.id);case 4:case"end":return t.stop()}}),t)}))),mt.apply(this,arguments)}function gt(t,e,n){return vt.apply(this,arguments)}function vt(){return vt=Object(a["a"])(regeneratorRuntime.mark((function t(e,n,r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht.put("/story/".concat(e),{story:n},{headers:{Authorization:"Bearer ".concat(r)}});case 2:return a=t.sent,t.abrupt("return",a.data.id);case 4:case"end":return t.stop()}}),t)}))),vt.apply(this,arguments)}n("28a5");var yt="data-cs-bbox",Ot=$t(yt),kt="data-cs-lat",jt="data-cs-lng",xt=$t(kt),_t=$t(jt),wt="mark-click",Ct="track-file-upload";function $t(t){return t.split("-").map((function(t,e){return e>0?t.slice(0,1).toUpperCase()+t.slice(1):t})).join("")}var St,At=function(t){return t[t.length-1]},Et=function(t){return function(e,n){e[t]=n}},Rt=function(t){return function(e,n){var r=t.slice(0,-1).reduce((function(e,n,r){return n in e||(e[n]="number"===typeof t[r+1]?[]:{}),e[n]}),e);r[At(t)]=n}};o["a"].use(s["a"]);var Tt={auth:{token:void 0},editable:!1,errors:[],bboxBeingAdded:{active:!1,bounds:void 0},featureBeingAdded:{active:!1,position:void 0},loading:!1,storyUrl:void 0,story:{author:void 0,name:void 0,text:void 0,track:void 0},availableStories:[],highlightedBbox:void 0,highlightedLatLng:void 0,shouldTextScroll:void 0},Pt=(St={},Object(rt["a"])(St,$,Rt(["auth","token"])),Object(rt["a"])(St,h,(function(t,e){var n=t.errors.findIndex((function(t){return t.title===e.title&&t.message===e.message}));n>-1&&t.errors.splice(n,1)})),Object(rt["a"])(St,p,Et("bboxBeingAdded")),Object(rt["a"])(St,m,Et("featureBeingAdded")),Object(rt["a"])(St,b,Et("editable")),Object(rt["a"])(St,f,(function(t,e){t.errors=[].concat(Object(at["a"])(t.errors),[e])})),Object(rt["a"])(St,g,(function(t,e){var n;e&&(n=[{lat:e[0][0],lng:e[0][1]},{lat:e[1][0],lng:e[1][1]}]),t.highlightedBbox=n})),Object(rt["a"])(St,v,(function(t,e){t.highlightedLatLng=e?{lat:Number.parseFloat(e[kt]),lng:Number.parseFloat(e[jt])}:void 0})),Object(rt["a"])(St,y,Et("loading")),Object(rt["a"])(St,O,Rt(["map","center"])),Object(rt["a"])(St,k,Et("shouldTextScroll")),Object(rt["a"])(St,j,Et("story")),Object(rt["a"])(St,x,Rt(["story","author"])),Object(rt["a"])(St,_,Rt(["story","name"])),Object(rt["a"])(St,w,Rt(["story","text"])),Object(rt["a"])(St,C,Et("storyUrl")),Object(rt["a"])(St,S,Rt(["story","track"])),St),Lt={updateTrack:function(t,e){var n=t.commit;n(S,e)},updateStoryText:function(t,e){var n=t.commit;n(w,e)},loadStory:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,r(y,!0),t.next=4,ft(n.storyUrl,n.token);case 4:a=t.sent.data.story,r(j,a.story),r(x,a.email),r(y,!1);case 8:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},Bt={content:function(t){var e;return e=t.story.text&&t.story.text.state?t.story.text.state.doc.content:t.story.text&&t.story.text.content,e&&JSON.parse(JSON.stringify(e))},bboxes:function(t,e){var n=[],r=e.content;if(r){var a=Object(ct["a"])(r,yt);n=Object(st["a"])(a,(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t})).map((function(t){return JSON.parse(t)})).map((function(e,n){var r=Object(nt["a"])(e,2),a=r[0],i=r[1],o=!1;if(t.highlightedBbox){var s=t.highlightedBbox[0],c=s.lat,u=s.lng,l=t.highlightedBbox[1],d=l.lat,h=l.lng,p=[c,u,d,h];o=[].concat(Object(at["a"])(a),Object(at["a"])(i)).every((function(t,e){return t===p[e]}))}return{id:"bbox-".concat(n),bounds:[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],highlighted:o}}))}return n},features:function(t,e){var n=[],r=e.content;if(r){var a=Object(st["a"])(Object(ct["a"])(r,[kt,jt]),(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t}));n=ot()(a,2).map((function(e){var n=t.highlightedLatLng&&t.highlightedLatLng.lat,r=t.highlightedLatLng&&t.highlightedLatLng.lng;return{lat:e[0],lng:e[1],highlighted:e[0]===n&&e[1]===r}}))}return n}},Mt=new s["a"].Store({strict:!0,getters:Bt,state:Tt,mutations:Pt,actions:Lt}),Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns background has-no-margin"},[n("div",{staticClass:"column is-half is-offset-one-quarter"},[n("div",{staticClass:"box has-mt-2"},[n("h1",{staticClass:"title is-size-1 has-text-centered"},[t._v("Přihlášení")]),n("p",[t._v("Po přihlášení budete moct psát příběhy a sdílet je se svými přáteli.")]),t._m(0),n("p",[t._v("Pro přihlášení využíváme jen nezbytné minimum údajů o vašem účtu Google.")]),t.$auth.loading?t._e():n("div",{staticClass:"has-mt-1"},[t.$auth.isAuthenticated?t._e():n("b-button",{attrs:{type:"is-primary",expanded:""},on:{click:t.login}},[t._v("Přejít na přihlášení")]),t.$auth.isAuthenticated?n("b-button",{on:{click:t.logout}},[t._v("Log out")]):t._e()],1)])])])},Ut=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("V současné době podporujeme přihlášení pouze prostřednictvím účtu Google. K autentizaci\n        využíváme službu "),n("a",{attrs:{href:"https://auth0.com"}},[t._v("auth0")]),t._v(". Po kliknutí na tlačítko budete\n        přesměrováni na stránky služby.")])}],Nt={name:"Login",methods:{login:function(){this.$auth.loginWithRedirect()},logout:function(){this.$auth.logout({returnTo:window.location.origin})}}},zt=Nt,It=Object(F["a"])(zt,Dt,Ut,!1,null,"75696624",null),Ft=It.exports,Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loadingSignup?n("div",{staticClass:"has-text-centered has-mt-2"},[t._v("Ukládají se informace o uživatelském\núčtu…")]):t._e()},Jt=[],Gt=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht.post("/auth/signup",{email:e});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Vt={name:"LoginCallback",data:function(){return{loadingSignup:!1}},computed:{loading:function(){return this.$auth.loading}},watch:{loading:function(t){t||(this.$auth.user||this.$router.push("/login"),this.signup())}},methods:{signup:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$auth.user["https://cartostory.com/is_new"]){t.next=3;break}return this.$router.push("/"),t.abrupt("return");case 3:return this.loadingSignup=!0,t.next=6,this.$auth.getTokenSilently();case 6:return e=t.sent,this.$setAuthorizationHeader("Bearer ".concat(e)),t.prev=8,t.next=11,Gt(this.$auth.user.email);case 11:t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](8),this.$handleSignupError(t.t0);case 16:return t.prev=16,this.loadingSignup=!1,this.$router.push("/"),t.finish(16);case 20:case"end":return t.stop()}}),t,this,[[8,13,16,20]])})));function e(){return t.apply(this,arguments)}return e}(),$handleSignupError:function(t){"User already exists"!==t.response.data.message&&this.$store.commit(f,{title:"Chyba",message:"Pokus o založení uživatelského účtu selhal."})},$setAuthorizationHeader:function(t){ht.defaults.headers.common.Authorization=t}}},Wt=Vt,qt=Object(F["a"])(Wt,Ht,Jt,!1,null,null,null),Kt=qt.exports,Yt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Zt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns background has-no-margin"},[n("div",{staticClass:"column is-half"},[n("h1",{staticClass:"claim has-pl-1"},[t._v("Cartostory je plné příběhů")])]),n("div",{staticClass:"column is-half"},[n("div",{staticClass:"box has-padding-2"},[n("h1",{staticClass:"title is-1 has-text-centered"},[t._v("Každý příběh je plný dobrodružství…")]),n("p",[t._v("Určitě už jste zažili v přírodě dobrodružství, které se vám vrylo hluboko do paměti.\n      Zachytili jste ho na fotkách, možná i na videu, pomocí chytrých hodinek nebo mobilu jste\n      měřili rychlost, tep, spálené kalorie. Děláme to tak všichni, ne?")]),n("p",[t._v("Možná za dobrodružstvím ale nevyrážíte jen kvůli grafu tepové frekvence.\n      Možná, stejně jako my, vyrážíte i pro ten pocit, že se něco děje, pro radost z pohybu, za\n      novými objevy.")])])])])}],Xt={name:"Landing"},Qt=Xt,te=(n("421f"),Object(F["a"])(Qt,Yt,Zt,!1,null,"79f09e50",null)),ee=te.exports,ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?t._e():n("div",{staticClass:"container-fluid story-form"},[n("div",{staticClass:"wrapper columns has-margin-0"},[n("cs-map"),n("div",{staticStyle:{display:"flex","flex-direction":"column",width:"100%"}},[n("cs-editor")],1)],1)])},re=[],ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-12 has-padding-0 story-text",staticStyle:{display:"flex"}},[n("div",{staticClass:"story-text__content"},[t.editable?n("form",{staticClass:"has-mt-1"},[n("b-field",[n("b-input",{attrs:{"custom-class":"story-title-input",placeholder:"Název příběhu",size:"is-large"},model:{value:t.storyName,callback:function(e){t.storyName=e},expression:"storyName"}})],1)],1):t._e(),t.editable?t._e():n("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-evenly"}},[n("h1",{staticClass:"story-title-input has-mt-1",staticStyle:{flex:"1"}},[t._v(t._s(t.storyName))]),t.showEditButton?n("b-button",{attrs:{size:"is-small","icon-left":"pencil"},on:{click:t.handleStartEditing}},[t._v("Upravit")]):t._e()],1),t.editable?n("menu-bar",{attrs:{saving:t.saving,editor:t.editor},scopedSlots:t._u([{key:"cancel-button",fn:function(){return[n("b-button",{staticClass:"menubar__button",staticStyle:{"margin-left":"auto"},attrs:{size:"is-small"},on:{click:t.handleCancelEditing}},[t._v("Zrušit\n        ")])]},proxy:!0},{key:"submit-button",fn:function(){return[n("b-button",{staticClass:"menubar__button",attrs:{loading:t.saving,size:"is-small",type:"is-primary"},on:{click:t.handleSave}},[t._v("Uložit\n        ")])]},proxy:!0}],null,!1,4264853847)}):t._e(),t.editable?n("menu-bubble",{attrs:{editor:t.editor},on:{changed:t.handleContentUpdate},nativeOn:{click:function(e){return t.handleContentUpdate(e)}}}):t._e(),n("editor-content",{staticClass:"editor has-mt-1 has-mb-1",class:{editable:this.editable},staticStyle:{flex:"1",overflow:"auto"},attrs:{editor:t.editor}})],1)])},ie=[],oe=(n("8e6e"),n("456d"),n("7f7f"),n("cd3f")),se=n.n(oe),ce=n("cd42"),ue=n("f23d"),le=(n("6b54"),n("2397"),n("d225")),de=n("b0b4"),he=n("308d"),pe=n("6bb5"),fe=n("4e2b"),be=n("a9de");function me(t){var e;return e="lat"in t[0]?"[[".concat(t[0].lat,",").concat(t[0].lng,"],[").concat(t[1].lat,",").concat(t[1].lng,"]]"):"[[".concat(t[0][0],",").concat(t[0][1],"],[").concat(t[1][0],",").concat(t[1][1],"]]"),e}function ge(t){return"[".concat(yt,"='").concat(me(t),"']")}function ve(t){var e;return e="lat"in t?"[".concat(kt,"='").concat(t.lat,"'], [").concat(jt,"='").concat(t.lng,"']"):"[".concat(kt,"='").concat(t[0],"'], [").concat(jt,"='").concat(t[1],"']"),e}function ye(t){return function(){var e,n=Object(pe["a"])(t);if(Oe()){var r=Object(pe["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(he["a"])(this,e)}}function Oe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var ke="a",je=function(t){Object(fe["a"])(n,t);var e=ye(n);function n(){return Object(le["a"])(this,n),e.apply(this,arguments)}return Object(de["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]];return Object(be["a"])(e,Object(rt["a"])({},yt,JSON.stringify(n)))}}},{key:"name",get:function(){return"bboxMark"}},{key:"schema",get:function(){return{attrs:Object(rt["a"])({},yt,{default:null}),parseDOM:[{tag:ke,getAttrs:function(t){return Object(rt["a"])({},yt,t.dataset[yt])}}],toDOM:function(t){return[ke,Object(rt["a"])({},yt,t.attrs[yt]),0]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t=JSON.parse(this[Ot]);this.$store.commit(v,void 0),this.$store.commit(g,t)}},computed:Object(rt["a"])({isHighlighted:function(){if(!this.$store.state.highlightedBbox)return!1;var t=this[Ot],e=me(this.$store.state.highlightedBbox);return e===t}},Ot,{get:function(){return this.node.attrs[yt]},set:function(t){this.updateAttrs(Object(rt["a"])({},yt,t))}}),template:'\n        <a\n          title="Kliknutím vycentrujete mapu"\n          :class="{\'is-highlighted\': isHighlighted}"\n          :'.concat(yt,'="').concat(Ot,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(ce["f"]);function xe(t){return function(){var e,n=Object(pe["a"])(t);if(_e()){var r=Object(pe["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(he["a"])(this,e)}}function _e(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var we="a",Ce=function(t){Object(fe["a"])(n,t);var e=xe(n);function n(){return Object(le["a"])(this,n),e.apply(this,arguments)}return Object(de["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n;return Object(be["a"])(e,(n={},Object(rt["a"])(n,kt,t&&t[kt]),Object(rt["a"])(n,jt,t&&t[jt]),n))}}},{key:"name",get:function(){return"featureMark"}},{key:"schema",get:function(){var t;return{attrs:(t={},Object(rt["a"])(t,kt,{default:null}),Object(rt["a"])(t,jt,{default:null}),t),parseDOM:[{tag:we,getAttrs:function(t){var e;return e={},Object(rt["a"])(e,kt,t.dataset[kt]),Object(rt["a"])(e,jt,t.dataset[jt]),e}}],toDOM:function(t){var e;return[we,(e={},Object(rt["a"])(e,kt,t.attrs[kt]),Object(rt["a"])(e,jt,t.attrs[jt]),e),0]}}}},{key:"view",get:function(){var t;return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t,e=(t={},Object(rt["a"])(t,kt,this[xt]),Object(rt["a"])(t,jt,this[_t]),t);this.$store.commit(k,!1),this.$store.commit(g,void 0),this.$store.commit(v,e)}},computed:(t={isHighlighted:function(){if(!this.$store.state.highlightedLatLng)return!1;var t=this.$store.state.highlightedLatLng,e=t.lat,n=t.lng;return e===this[xt]&&n===this[_t]}},Object(rt["a"])(t,xt,{get:function(){return this.node.attrs[kt]},set:function(t){this.updateAttrs(Object(rt["a"])({},kt,t))}}),Object(rt["a"])(t,_t,{get:function(){return this.node.attrs[jt]},set:function(t){this.updateAttrs(Object(rt["a"])({},jt,t))}}),t),template:'\n        <a\n          title="Kliknutím vycentrujete mapu"\n          :class="{\'is-highlighted\': isHighlighted}"\n          :'.concat(jt,'="').concat(_t,'"\n          :').concat(kt,'="').concat(xt,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(ce["f"]),$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bar",{staticClass:"has-mt-1",staticStyle:{background:"white"},attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.isActive;return[n("div",{staticClass:"editor-menu-bar buttons"},[n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:2})},attrs:{title:"Nadpis 1. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:2})}}},[t._v("\n      H1\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:3})},attrs:{title:"Nadpis 2. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:3})}}},[t._v("\n      H2\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:4})},attrs:{title:"Nadpis 3. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:4})}}},[t._v("\n      H3\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.image()},attrs:{title:"Obrázek",size:"is-small"},on:{click:function(e){return t.showImagePrompt(r.image)}}},[n("b-icon",{attrs:{size:"is-small",icon:"image-filter-hdr","custom-class":"image-icon"}})],1),t._t("cancel-button"),t._t("submit-button")],2)]}}],null,!0)})},Se=[],Ae={name:"MenuBar",components:{EditorMenuBar:ce["c"]},props:["editor","saving"],methods:{showImagePrompt:function(t){var e=prompt("Enter the url of your image here");e&&t({src:e})}}},Ee=Ae,Re=Object(F["a"])(Ee,$e,Se,!1,null,"5a8817c2",null),Te=Re.exports,Pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":!0},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.getMarkAttrs,i=e.isActive,o=e.menu;return[n("div",{staticClass:"menububble",class:{"is-active":o.isActive},style:"left: "+o.left+"px; bottom: "+o.bottom+"px;"},[t.isNewFeatureMarkButtonVisible(a("featureMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__mark",class:{"is-active":i.featureMark()},attrs:{"icon-left":"map-marker-plus"},on:{click:function(e){return t.handleAddFeatureMarkClick(r.featureMark)}}}),t.isNewFeatureMarkButtonVisible(a("featureMark"))?n("b-button",{staticClass:"menububble__button",class:{"is-active":i.featureMark()},attrs:{"icon-left":"map-marker-minus"},on:{click:function(e){return t.handleRemoveFeatureMarkClick(r.featureMark)}}}):t._e(),t.isNewBboxMarkVisible(a("bboxMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":i.bboxMark()},attrs:{"icon-left":"fullscreen"},on:{click:function(e){return t.handleAddBoundingBoxClick(r.bboxMark)}}}),t.isNewBboxMarkVisible(a("bboxMark"))?n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":i.bboxMark()},attrs:{"icon-left":"fullscreen-exit"},on:{click:function(t){return r.bboxMark()}}}):t._e()],1)]}}])})},Le=[];function Be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Me(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Be(Object(n),!0).forEach((function(e){Object(rt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var De={data:function(){return{bboxAddedCallback:void 0,featureMarkAddedCallback:void 0}},name:"MenuBubble",props:["editor"],components:{EditorMenuBubble:ce["d"]},computed:Me({},Object(s["c"])({bboxBeingAdded:function(t){return t.bboxBeingAdded},featureBeingAdded:function(t){return t.featureBeingAdded}})),watch:{bboxBeingAdded:function(t){t&&t.active&&t.bounds&&this.bboxAddedCallback&&(this.bboxAddedCallback(t.bounds),this.bboxAddedCallback=void 0,this.$store.commit(p,{active:!1,position:void 0}),this.$emit("changed"))},featureBeingAdded:function(t){t&&t.active&&t.position&&this.featureMarkAddedCallback&&(this.featureMarkAddedCallback(t.position),this.featureMarkAddedCallback=void 0,this.$store.commit(m,{active:!1,position:void 0}),this.$emit("changed"))}},methods:{isNewFeatureMarkButtonVisible:function(t){return t&&t[kt]},isNewBboxMarkVisible:function(t){return t&&t[yt]},handleAddFeatureMarkClick:function(t){this.featureMarkAddedCallback=t,this.$store.commit(m,{active:!0,position:void 0})},handleRemoveFeatureMarkClick:function(t){this.$store.commit(v,void 0),t()},handleAddBoundingBoxClick:function(t){this.bboxAddedCallback=t,this.$store.commit(p,{active:!0,bounds:void 0})}}},Ue=De,Ne=(n("b7dd"),Object(F["a"])(Ue,Pe,Le,!1,null,"620f66f7",null)),ze=Ne.exports;function Ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ie(Object(n),!0).forEach((function(e){Object(rt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var He={name:"CsEditor",components:{EditorContent:ce["b"],MenuBubble:ze,MenuBar:Te},data:function(){return{content:"Můžete začít psát...",editor:void 0,previousContent:void 0,saving:!1,storyId:void 0,keepInBounds:!0}},computed:Fe({},Object(s["c"])(["editable","highlightedBbox","highlightedLatLng","shouldTextScroll"]),{},Object(s["c"])({author:function(t){return t.story.author},text:function(t){return t.story.text},token:function(t){return t.auth.token},track:function(t){return t.story.track}}),{showEditButton:function(){return this.author===this.$auth.user.email},storyName:{get:function(){return this.$store.state.story.name},set:function(t){this.$store.commit(_,t)}}}),watch:{highlightedLatLng:function(t){t&&this.scrollToHighlighted()},highlightedBbox:function(t){t&&this.scrollToHighlighted()}},beforeMount:function(){this.$hideScrollbar()},beforeDestroy:function(){document.documentElement.classList.remove("is-clipped"),this.editor.destroy()},created:function(){this.storyId=this.$route.params&&this.$route.params.id},mounted:function(){this.editor=this.$createEditor(),this.text&&this.editor.setContent(this.text)},methods:{handleCancelEditing:function(){var t=this;this.$buefy.dialog.confirm({message:"Opravdu chcete zahodit změny?",cancelText:"Ne",confirmText:"Ano",onCancel:function(){return t.$hideScrollbar()},onConfirm:function(){t.$store.commit(b,!1),t.editor.setOptions({editable:!1}),t.editor.setContent(t.previousContent),t.$hideScrollbar()}})},handleContentUpdate:function(){this.$store.commit(w,se()(this.editor.getJSON()))},handleStartEditing:function(){this.$store.commit(b,!0),this.editor.setOptions({editable:!0}),this.previousContent=se()(this.editor.getJSON())},handleSave:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.handleContentUpdate(),e={name:this.storyName,text:this.text,track:this.track},this.storyId&&(e.id=this.storyId),t.prev=3,this.saving=!0,t.next=7,pt(e,this.token);case 7:this.storyId=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),this.$store.commit(f,{title:t.t0.name,message:t.t0.message});case 13:return t.prev=13,this.saving=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[3,10,13,16]])})));function e(){return t.apply(this,arguments)}return e}(),scrollToHighlighted:function(){var t=this.$getHighlightedNode();t&&this.$scrollTo(t,void 0,{container:document.querySelector(".editor"),offset:-50})},$getHighlightedNode:function(){var t;if(this.shouldTextScroll)return this.highlightedLatLng&&(t=ve(this.highlightedLatLng)),this.highlightedBbox&&(t=ge(this.highlightedBbox)),document.querySelector(t)},$createEditor:function(){return new ce["a"]({editable:this.editable,extensions:[new je,new Ce,new ue["a"]({levels:[2,3,4]}),new ue["b"]],content:this.content})},$hideScrollbar:function(){document.documentElement.classList.add("is-clipped")}}},Je=He,Ge=(n("116c"),Object(F["a"])(Je,ae,ie,!1,null,null,null)),Ve=Ge.exports,We=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-6 has-padding-0"},[n("div",{staticClass:"cs-map"},[n("div",{attrs:{id:"cs-map-container"}},[n("l-map",{ref:"csmap",attrs:{bounds:t.mapBounds,center:t.mapCenter,zoom:t.mapOptions.zoom},on:{click:function(e){return t.handleMapClick(e.latlng)},mousedown:function(e){return t.handleMapMouseDown(e.latlng)}}},[n("l-control",{staticClass:"leaflet-bar leaflet-control",attrs:{position:"topleft"}},[t.editable?n("cs-track-upload-button",{on:t._d({},[t.TRACK_FILE_UPLOAD_EVENT,function(e){return t.handleFileUpload(e)}])}):t._e()],1),n("l-tile-layer",{attrs:{url:t.mapOptions.baseLayer}}),n("l-tile-layer",{attrs:{url:t.mapOptions.hikingOverlay,"layer-type":"overlay",opacity:.4}}),n("l-tile-layer",{attrs:{url:t.mapOptions.labelsOverlay,"layer-type":"overlay"}}),t.track?n("l-geo-json",{ref:"cstrack",attrs:{geojson:t.track,options:t.trackOptions.style.plain},on:{ready:function(e){return t.handleTrackReady(e)}}}):t._e(),t._l(t.bboxes,(function(e){return n("l-rectangle",{key:e.id,attrs:{bounds:e.bounds,"l-style":e.highlighted?t.bboxOptions.selected.style:t.bboxOptions.plain.style},on:{click:function(n){return t.handleBboxClick(n,e)}}})})),t._l(t.features,(function(e,r){return n("l-circle-marker",{key:r,attrs:{color:e.highlighted?t.markerOptions.style.highlighted.color:t.markerOptions.style.plain.color,"fill-color":e.highlighted?t.markerOptions.style.highlighted.color:t.markerOptions.style.plain.color,"fill-opacity":e.highlighted?t.markerOptions.style.highlighted.fillOpacity:t.markerOptions.style.plain.fillOpacity,latLng:e,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}})}))],2)],1)])])},qe=[],Ke=n("ea97"),Ye=n("2253c"),Ze=n("044a"),Xe=n("2699"),Qe=n("a40a"),tn=n("fb8e"),en={bounds:void 0,center:[50,19],baseLayer:"https://api.mapbox.com/styles/v1/cartostory/cjugqcypf27581gnry4y59lxy/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",hikingOverlay:"http://tile.mtbmap.cz/overlay_hiking/{z}/{x}/{y}.png",labelsOverlay:"https://api.mapbox.com/styles/v1/cartostory/cjugqfe8r1lhh1ftgrmr7v9zj/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",zoom:8,edgeMarker:void 0},nn={style:{common:{radius:8,weight:1.5},highlighted:{color:"#F56C6C",opacity:1,fillOpacity:.4},inBbox:{color:"#42b983",fillOpacity:.5},plain:{color:"#3185fc",fillOpacity:.5},edge:{icon:{iconUrl:"../../node_modules/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]}}}},rn={plain:{style:{color:"#5a5a66",fillOpacity:0,dashArray:"5",weight:2}},hovered:{style:{color:"#5a5a66",fillColor:"#5a5a66",dashArray:"5",weight:2}},selected:{style:{color:"#42b983",fillColor:"#42b983",fillOpacity:0,dashArray:"5",weight:2}}},an={style:{plain:{color:"#5a5a66",dashArray:"6"},inBbox:{color:"#42b983",dashArray:"6"}}},on=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("file-reader",{staticStyle:{height:"30px",width:"30px","line-height":"30px"},attrs:{accept:".json",output:"text"},on:{"reader-load":t.handleFileUpload},scopedSlots:t._u([{key:"reader",fn:function(e){return[n("b-button",{staticClass:"file-upload-button",attrs:{title:"Nahrát soubor trasy",size:"is-small","icon-left":"cloud-upload"},on:{click:function(e){return t.$refs.fileReader.click()}}}),n("input",{ref:"fileReader",staticStyle:{visibility:"hidden"},attrs:{type:"file",accept:e.accept},on:{change:e.onchange}})]}}])})},sn=[],cn=n("5112"),un=n.n(cn),ln={name:"CsTrackUploadButton",components:{FileReader:un.a},methods:{handleFileUpload:function(t){try{this.$emit(Ct,t&&JSON.parse(t.data))}catch(e){this.$store.commit(f,{title:"Selhalo nahrání trasy",message:"Trasu se nepodařilo nahrát. Soubor pravděpodobně není validní."})}}}},dn=ln,hn=(n("d51c"),Object(F["a"])(dn,on,sn,!1,null,"6f11a710",null)),pn=hn.exports;function fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fn(Object(n),!0).forEach((function(e){Object(rt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n("6cc5"),n("20d6b");var mn={name:"CsMap",components:{CsTrackUploadButton:pn,LCircleMarker:Ke["a"],LControl:Ye["a"],LGeoJson:Ze["a"],LMap:Xe["a"],LTileLayer:Qe["a"],LRectangle:tn["a"]},data:function(){return{STORY_LINK_CLICK_EVENT:wt,TRACK_FILE_UPLOAD_EVENT:Ct,bboxOptions:rn,drawControl:void 0,markerOptions:nn,mapOptions:en,trackOptions:an}},computed:bn({mapBounds:function(){var t=this.highlightedBbox;if(this.recenterMap&&t)return window.L.latLngBounds(t)},mapCenter:function(){var t=this.mapBounds&&this.mapBounds.getCenter(),e=this.$refs.csmap&&this.$refs.csmap.mapObject.getCenter(),n=this.recenterMap&&this.highlightedLatLng;return t||n||e}},Object(s["b"])(["bboxes","features","featuresWithoutHighlighted"]),{},Object(s["c"])(["bboxBeingAdded","editable","featureBeingAdded","highlightedBbox","highlightedLatLng","shouldTextScroll"]),{},Object(s["c"])({recenterMap:function(t){return!t.shouldTextScroll},track:function(t){return t.story.track}})),methods:{handleTrackReady:function(t){this.$refs.csmap.mapObject.fitBounds(t.getBounds())},handleBboxClick:function(t,e){var n=ge(e.bounds),r=document.querySelector(n);r&&(this.$store.commit(v,void 0),this.$store.commit(g,e.bounds),this.$store.commit(k,!0))},handleFeatureClick:function(t){var e,n=ve(t.latlng),r=document.querySelector(n);r&&(this.$store.commit(v,(e={},Object(rt["a"])(e,kt,r.getAttribute([kt])),Object(rt["a"])(e,jt,r.getAttribute([jt])),e)),this.$store.commit(g,void 0),this.$store.commit(k,!0))},handleMapClick:function(t){var e;if(this.featureBeingAdded.active){var n=(e={},Object(rt["a"])(e,kt,t.lat),Object(rt["a"])(e,jt,t.lng),e);this.$store.commit(m,{active:!0,position:n})}},handleMapMouseDown:function(){if(this.bboxBeingAdded.active){var t=this.$refs.csmap.mapObject;window.L.drawLocal.draw.handlers.rectangle.tooltip.start="",window.L.drawLocal.draw.handlers.simpleshape.tooltip.end="",new window.L.Draw.Rectangle(t,{showArea:!1,shapeOptions:this.bboxOptions.plain.style}).enable(),t.off(window.L.Draw.Event.CREATED),t.on(window.L.Draw.Event.CREATED,this.$handleCreateRectangle)}},handleFileUpload:function(t){this.$store.commit(S,t)},$handleCreateRectangle:function(t){var e=t.layer.getBounds(),n=e.getNorthWest(),r=e.getSouthEast(),a=[[n.lat,n.lng],[r.lat,r.lng]];this.$store.commit(p,{active:!0,bounds:a})}}},gn=mn,vn=(n("bafc"),Object(F["a"])(gn,We,qe,!1,null,"0c9320d8",null)),yn=vn.exports,On={name:"story-screen",components:{CsEditor:Ve,CsMap:yn},data:function(){return{storyId:void 0}},computed:{editable:function(){return this.$store.state.editable},token:function(){return this.$store.state.auth.token},loading:function(){return this.$store.state.loading}},watch:{token:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,this.$store.dispatch("loadStory",{storyUrl:this.storyId,token:e});case 3:this.$store.commit(y,!1);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},created:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.storyId=this.$route.params&&this.$route.params.id,this.storyId&&this.$store.commit(y,!0);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},kn=On,jn=(n("c68b"),Object(F["a"])(kn,ne,re,!1,null,"1ee03396",null)),xn=jn.exports,_n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mt-2"},[t._v("Cartostory")]),n("div",{staticClass:"card has-padding-1"},[n("div",{staticClass:"card-content"},[t.availableStories.length>0?n("b-field",{attrs:{label:"Nahrát příběh"}},[n("b-select",{attrs:{placeholder:"Příběh",expanded:""},on:{input:t.handleStorySelect}},t._l(t.availableStories,(function(e){return n("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.name)+"\n            ")])})),0)],1):t._e(),n("b-field",{attrs:{label:"URL příběhu"}},[n("b-input",{attrs:{type:"text",expanded:""},model:{value:t.storyUrl,callback:function(e){t.storyUrl=e},expression:"storyUrl"}})],1),n("b-button",{attrs:{disabled:t.disabledSubmit,type:"is-primary"},on:{click:t.handleSubmit}},[t._v("Načíst")])],1)])])])])},wn=[],Cn=(n("7514"),n("f788")),$n=n.n(Cn);function Sn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function An(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sn(Object(n),!0).forEach((function(e){Object(rt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var En={name:"LoadStoryForm",data:function(){return{currentStory:void 0}},computed:An({},Object(s["c"])({availableStories:function(t){return t.availableStories},storyName:function(t){return t.story.name},storyText:function(t){return t.story.text}}),{disabledSubmit:function(){return!this.storyUrl},storyUrl:{get:function(){return this.$store.state.storyUrl},set:function(t){this.$store.commit(C,t)}}}),methods:{handleSubmit:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("loadStory");case 3:e=$n()(this.storyName).toLowerCase(),this.$router.push("/story/read/".concat(e)),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$store.commit(f,{title:"Příběh se nepodařilo nahrát",message:"Zkontrolujte jeho adresu."});case 10:return t.prev=10,this.$store.commit(y,!1),t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,7,10,13]])})));function e(){return t.apply(this,arguments)}return e}(),handleStorySelect:function(t){var e=this.availableStories.find((function(e){return e.name===t}));e&&(this.storyUrl=e.storyUrl)}}},Rn=En,Tn=Object(F["a"])(Rn,_n,wn,!1,null,"6706dcd3",null),Pn=Tn.exports;o["a"].use(et["a"]);var Ln=[{path:"/",component:ee},{path:"/login",component:Ft},{path:"/login-callback",component:Kt},{path:"/story/read/:id",component:xn,beforeEnter:function(t,e,n){Mt.commit(b,!1),n()}},{path:"/story/load",component:Pn},{path:"/story/create",component:xn,beforeEnter:function(t,e,n){Mt.commit(b,!0),n()}}],Bn=new et["a"]({mode:"history",base:"/",routes:Ln});Bn.beforeEach((function(t,e,n){Mt.commit(y,!0),n()})),Bn.afterEach((function(){Mt.commit(y,!1)}));var Mn=Bn;n("6cc5"),o["a"].config.productionTip=!1,o["a"].use(i["a"]),o["a"].use(u.a),o["a"].use(d.a),o["a"].use(s["a"]),o["a"].use(B,{audience:A["a"],domain:A["c"],clientId:A["b"],onRedirectCallback:function(t){Mn.push(t&&t.targetUrl?t.targetUrl:window.location.pathname)}}),new o["a"]({store:Mt,router:Mn,render:function(t){return t(tt)}}).$mount("#js-cartostory");var Dn=P();Dn.$watch("loading",function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e||!Dn.isAuthenticated){t.next=5;break}return t.next=3,Dn.getTokenSilently();case 3:n=t.sent,Mt.commit($,n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},6297:function(t,e,n){},8160:function(t){t.exports=JSON.parse('{"a":"https://auth0-jwt-authorizer","c":"carto-story.eu.auth0.com","b":"1Zc7PhZxhB8MDtkYxdPTjvc3Q63ssSnk"}')},"8ca6":function(t,e,n){},"9dc3":function(t,e,n){},"9e12":function(t,e,n){},a41b:function(t,e,n){},b7dd:function(t,e,n){"use strict";var r=n("3fab"),a=n.n(r);a.a},bafc:function(t,e,n){"use strict";var r=n("9dc3"),a=n.n(r);a.a},c68b:function(t,e,n){"use strict";var r=n("305c"),a=n.n(r);a.a},d51c:function(t,e,n){"use strict";var r=n("6297"),a=n.n(r);a.a}});
//# sourceMappingURL=app.820be6e4.js.map