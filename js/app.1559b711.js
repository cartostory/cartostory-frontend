(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],d=0,b=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&b.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(b.length)b.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"116c":function(t,e,n){"use strict";var r=n("9e12"),a=n.n(r);a.a},"33f4":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("289d"),a=n("a026"),o=n("2f62"),i=n("85ff"),s=n.n(i),c=n("f13c"),l=n.n(c),u=(n("f5df"),n("a41b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section",attrs:{id:"js-app"}},[n("router-view"),n("cs-notification"),n("b-loading",{attrs:{"is-full-page":!0,active:t.loading},on:{"update:active":function(e){t.loading=e}}})],1)}),d=[],b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},f=[],h=(n("ac6a"),"REMOVE_ERROR"),p="UPDATE_BBOX_BEING_ADDED",m="UPDATE_BOUNDING_BOX_CALLBACK",g="UPDATE_ERRORS",v="UPDATE_EDITABLE",y="UPDATE_FEATURE_BEING_ADDED",O="UPDATE_HIGHLIGHTED_BBOX",j="UPDATE_HIGHLIGHTED_LAT_LNG",k="UPDATE_LOADING",_="UPDATE_MAP_CENTER",x="UPDATE_STORY",C="UPDATE_STORY_NAME",w="UPDATE_STORY_TEXT",A="UPDATE_STORY_URL",E="UPDATE_TRACK",S={name:"CsNotification",computed:{errors:function(){var t=this;return this.$store.state.errors.forEach((function(e){t.$buefy.snackbar.open({indefinite:!0,position:"is-top-right",type:"is-danger",message:"<strong>".concat(e.title,"</strong><br/><p>").concat(e.message,"</p>"),onAction:function(){t.$store.commit(h,e)}}),t.$store.commit(h,e)})),this.$store.state.errors}},watch:{errors:function(){return this.errors}}},L=S,P=n("2877"),D=Object(P["a"])(L,b,f,!1,null,null,null),M=D.exports,B={name:"app",components:{CsNotification:M},computed:{loading:function(){return this.$store.state.loading}}},$=B,N=Object(P["a"])($,u,d,!1,null,null,null),T=N.exports,R=n("8c4f"),U=(n("96cf"),n("3b8d")),z=n("bd86"),F=(n("c5f6"),n("5df2"),n("75fc")),I=(n("20d6"),n("bc3a")),H=n.n(I),J=n("89c7"),G=n.n(J),V=n("c2d0"),q=n("7e8c"),W=(n("28a5"),"data-cs-bbox"),X=nt(W),Y="data-cs-lat",Z="data-cs-lng",K=nt(Y),Q=nt(Z),tt="mark-click",et="track-file-upload";function nt(t){return t.split("-").map((function(t,e){return e>0?t.slice(0,1).toUpperCase()+t.slice(1):t})).join("")}var rt,at=function(t){return t[t.length-1]},ot=function(t){return function(e,n){e[t]=n}},it=function(t){return function(e,n){var r=t.slice(0,-1).reduce((function(e,n,r){return n in e||(e[n]="number"===typeof t[r+1]?[]:{}),e[n]}),e);r[at(t)]=n}};a["a"].use(o["a"]);var st={editable:!1,errors:[],bboxBeingAdded:{active:!1,bounds:void 0},featureBeingAdded:{active:!1,position:void 0},loading:!1,storyUrl:void 0,story:{name:void 0,text:void 0,track:void 0},addBoundingBoxCallback:void 0,availableStories:[],highlightedBbox:void 0,highlightedLatLng:void 0},ct=(rt={},Object(z["a"])(rt,h,(function(t,e){var n=t.errors.findIndex((function(t){return t.title===e.title&&t.message===e.message}));n>-1&&t.errors.splice(n,1)})),Object(z["a"])(rt,m,ot("addBoundingBoxCallback")),Object(z["a"])(rt,p,ot("bboxBeingAdded")),Object(z["a"])(rt,y,ot("featureBeingAdded")),Object(z["a"])(rt,v,ot("editable")),Object(z["a"])(rt,g,(function(t,e){t.errors=[].concat(Object(F["a"])(t.errors),[e])})),Object(z["a"])(rt,O,(function(t,e){t.highlightedBbox=[{lat:e[0][0],lng:e[0][1]},{lat:e[1][0],lng:e[1][1]}]})),Object(z["a"])(rt,j,(function(t,e){t.highlightedLatLng=e?{lat:Number.parseFloat(e[Y]),lng:Number.parseFloat(e[Z])}:void 0})),Object(z["a"])(rt,k,ot("loading")),Object(z["a"])(rt,_,it(["map","center"])),Object(z["a"])(rt,x,ot("story")),Object(z["a"])(rt,C,it(["story","name"])),Object(z["a"])(rt,w,it(["story","text"])),Object(z["a"])(rt,A,ot("storyUrl")),Object(z["a"])(rt,E,it(["story","track"])),rt),lt={updateTrack:function(t,e){var n=t.commit;n(E,e)},updateStoryText:function(t,e){var n=t.commit;n(w,e)},loadStory:function(){var t=Object(U["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,r=e.state,n(k,!0),t.next=4,H.a.get(r.storyUrl);case 4:a=t.sent,n(x,a.data);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},ut={content:function(t){var e;return e=t.story.text&&t.story.text.state?t.story.text.state.doc.content:t.story.text&&t.story.text.content,e&&JSON.parse(JSON.stringify(e))},bboxes:function(t,e){var n=[],r=e.content;if(r){var a=Object(q["a"])(r,W);n=Object(V["a"])(a,(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t})).map((function(t){return JSON.parse(t)})).map((function(t,e){return{id:e,bounds:[[t[0][0],t[0][1]],[t[1][0],t[1][1]]]}}))}return n},features:function(t,e){var n=[],r=e.content;if(r){var a=Object(V["a"])(Object(q["a"])(r,[Y,Z]),(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t}));n=G()(a,2).map((function(t){return{lat:t[0],lng:t[1]}}))}return n},featuresWithoutHighlighted:function(t,e){if(!t.highlightedLatLng)return e.features;var n=t.highlightedLatLng,r=n.lat,a=n.lng;return e.features.filter((function(t){return t.lat!==r&&t.lng!==a}))}},dt=new o["a"].Store({strict:!0,getters:ut,state:st,mutations:ct,actions:lt}),bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"hero is-fullheight"},[n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[t._m(0),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 section-left has-pb-0"},[n("h2",{staticClass:"title is-2 has-text-weight-normal has-text-centered has-mb-2"},[t._v("Napsat příběh")]),n("p",[t._v("Chcete napsat svůj vlastní příběh? Z prázdnin, dovolené nebo jen zajímavého sobotního\n                výletu?")]),n("b-button",{on:{click:function(e){return t.$router.push("/story/create")}}},[t._v("Chci psát")])],1),n("div",{staticClass:"column is-6 section-right has-pb-0"},[n("h2",{staticClass:"title is-2 has-text-weight-normal has-text-centered has-mb-2"},[t._v("Číst příběh")]),n("p",[t._v("Váš kamarád nebo příbuzný napsal příběh a poslal vám jeho adresu? Můžete si ho přečíst.")]),n("b-button",{on:{click:function(e){return t.$router.push("/story/load")}}},[t._v("Chci číst")])],1)])])])])])])},ft=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mb-1"},[t._v("Cartostory")])])])}],ht={name:"Landing"},pt=ht,mt=(n("6a2b"),Object(P["a"])(pt,bt,ft,!1,null,"40225d4e",null)),gt=mt.exports,vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid story-form"},[n("div",{staticClass:"columns has-margin-0",staticStyle:{height:"100vh"}},[n("cs-map"),n("div",{staticStyle:{display:"flex","flex-direction":"column",width:"100%"}},[t.$store.state.story.text||t.ready?n("cs-editor"):t._e()],1)],1)])},yt=[],Ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-12 has-padding-0 story-text"},[n("div",{staticClass:"story-text__content"},[t.editable?n("form",{staticClass:"has-mt-1"},[n("b-field",[n("b-input",{attrs:{"custom-class":"story-title-input",placeholder:"Název příběhu",size:"is-large"},model:{value:t.storyName,callback:function(e){t.storyName=e},expression:"storyName"}})],1)],1):t._e(),t.editable?t._e():n("h1",{staticClass:"story-title-input has-mt-1"},[t._v(t._s(t.storyName))]),t.editable?n("menu-bar",{attrs:{editor:t.editor}}):t._e(),t.editable?n("menu-bubble",{attrs:{editor:t.editor}}):t._e(),n("editor-content",{staticClass:"editor",class:{editable:this.editable},staticStyle:{flex:"1",overflow:"auto"},attrs:{editor:t.editor}})],1)])},jt=[],kt=(n("8e6e"),n("456d"),n("7f7f"),n("cd42")),_t=n("f23d"),xt=(n("6b54"),n("2397"),n("d225")),Ct=n("b0b4"),wt=n("308d"),At=n("6bb5"),Et=n("4e2b"),St=n("a9de");function Lt(t){return function(){var e,n=Object(At["a"])(t);if(Pt()){var r=Object(At["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(wt["a"])(this,e)}}function Pt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Dt="a",Mt=function(t){Object(Et["a"])(n,t);var e=Lt(n);function n(){return Object(xt["a"])(this,n),e.apply(this,arguments)}return Object(Ct["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]];return Object(St["r"])(e,Object(z["a"])({},W,JSON.stringify(n)))}}},{key:"name",get:function(){return"bboxMark"}},{key:"schema",get:function(){return{attrs:Object(z["a"])({},W,{default:null}),parseDOM:[{tag:Dt,getAttrs:function(t){return Object(z["a"])({},W,t.dataset[W])}}],toDOM:function(t){return[Dt,Object(z["a"])({},W,t.attrs[W]),0]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t=JSON.parse(this[X]);this.$store.commit(O,t)}},computed:Object(z["a"])({isHighlighted:function(){if(!this.$store.state.highlightedBbox)return!1;var t=this.$store.state.highlightedBbox;t.lat,t.lng;return!0}},X,{get:function(){return this.node.attrs[W]},set:function(t){this.updateAttrs(Object(z["a"])({},W,t))}}),template:"\n        <a\n          :class=\"{'is-highlighted': isHighlighted}\"\n          :".concat(W,'="').concat(X,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(kt["f"]);function Bt(t){return function(){var e,n=Object(At["a"])(t);if($t()){var r=Object(At["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(wt["a"])(this,e)}}function $t(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Nt="a",Tt=function(t){Object(Et["a"])(n,t);var e=Bt(n);function n(){return Object(xt["a"])(this,n),e.apply(this,arguments)}return Object(Ct["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n;return Object(St["r"])(e,(n={},Object(z["a"])(n,Y,t&&t[Y]),Object(z["a"])(n,Z,t&&t[Z]),n))}}},{key:"name",get:function(){return"featureMark"}},{key:"schema",get:function(){var t;return{attrs:(t={},Object(z["a"])(t,Y,{default:null}),Object(z["a"])(t,Z,{default:null}),t),parseDOM:[{tag:Nt,getAttrs:function(t){var e;return e={},Object(z["a"])(e,Y,t.dataset[Y]),Object(z["a"])(e,Z,t.dataset[Z]),e}}],toDOM:function(t){var e;return[Nt,(e={},Object(z["a"])(e,Y,t.attrs[Y]),Object(z["a"])(e,Z,t.attrs[Z]),e),0]}}}},{key:"view",get:function(){var t;return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t,e=(t={},Object(z["a"])(t,Y,this[K]),Object(z["a"])(t,Z,this[Q]),t);this.$store.commit(j,e)}},computed:(t={isHighlighted:function(){if(!this.$store.state.highlightedLatLng)return!1;var t=this.$store.state.highlightedLatLng,e=t.lat,n=t.lng;return e===this[K]&&n===this[Q]}},Object(z["a"])(t,K,{get:function(){return this.node.attrs[Y]},set:function(t){this.updateAttrs(Object(z["a"])({},Y,t))}}),Object(z["a"])(t,Q,{get:function(){return this.node.attrs[Z]},set:function(t){this.updateAttrs(Object(z["a"])({},Z,t))}}),t),template:"\n        <a\n          :".concat(Z,'="').concat(Q,'"\n          :').concat(Y,'="').concat(K,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(kt["f"]),Rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bar",{staticClass:"has-mt-1",staticStyle:{background:"white"},attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.isActive;return[n("div",{staticClass:"editor-menu-bar buttons"},[n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:2})},attrs:{title:"Nadpis 1. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:2})}}},[t._v("\n      H1\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:3})},attrs:{title:"Nadpis 2. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:3})}}},[t._v("\n      H2\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:4})},attrs:{title:"Nadpis 3. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:4})}}},[t._v("\n      H3\n    ")]),n("b-button",{staticClass:"menubar__button",staticStyle:{"margin-left":"auto"},attrs:{disabled:t.isDisabled,title:t.isDisabled?"Příběh zatím nelze uložit. Nahrajte prosím trasu, příběh pojmenujte a přidejte popis.":"Uložit příběh",size:"is-small",type:"is-primary"},on:{click:t.handleSave}},[t._v("Uložit\n    ")])],1)]}}])})},Ut=[],zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section"},[n("div",{staticClass:"container"},[t._m(0),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"has-padding-1",domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})])])},Ft=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns has-mb-0"},[n("div",{staticClass:"column has-pb-0"},[n("div",{staticClass:"notification"},[n("h1",{staticClass:"title is-1 has-text-centered"},[t._v("Uložení příběhu")]),n("p",[t._v("Zatím to jinak neumíme, proto si prosím celý příběh zkopírujte a uložte někam, odkud\n            ho budete moct později načíst (např. na "),n("a",{attrs:{href:"https://github.com"}},[t._v("GitHub")]),t._v(").")])])])])}],It={name:"StoryJson",props:{content:{required:!0,type:String}}},Ht=It,Jt=(n("ba4b"),Object(P["a"])(Ht,zt,Ft,!1,null,"4193dade",null)),Gt=Jt.exports;function Vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vt(Object(n),!0).forEach((function(e){Object(z["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wt={name:"MenuBar",components:{EditorMenuBar:kt["c"]},props:["editor"],computed:qt({},Object(o["c"])({name:function(t){return t.story.name},text:function(t){return t.story.text},track:function(t){return t.story.track}}),{isDisabled:function(){return!(this.name&&this.text&&this.track)}}),methods:{handleSave:function(){var t={name:this.name,text:this.text.getJSON(),track:this.track},e=JSON.stringify(t);this.$buefy.modal.open({component:Gt,parent:this,customClass:"modal-result",props:{content:e}})}}},Xt=Wt,Yt=Object(P["a"])(Xt,Rt,Ut,!1,null,"8d21fc90",null),Zt=Yt.exports,Kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":!0},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.getMarkAttrs,o=e.isActive,i=e.menu;return[n("div",{staticClass:"menububble",class:{"is-active":i.isActive},style:"left: "+i.left+"px; bottom: "+i.bottom+"px;"},[t.isNewFeatureMarkButtonVisible(a("featureMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__mark",class:{"is-active":o.featureMark()},attrs:{"icon-left":"map-marker-plus"},on:{click:function(e){return t.handleAddFeatureMarkClick(r.featureMark)}}}),t.isNewFeatureMarkButtonVisible(a("featureMark"))?n("b-button",{staticClass:"menububble__button",class:{"is-active":o.featureMark()},attrs:{"icon-left":"map-marker-minus"},on:{click:function(e){return t.handleRemoveFeatureMarkClick(r.featureMark)}}}):t._e(),t.isNewBboxMarkVisible(a("bboxMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":o.bboxMark()},attrs:{"icon-left":"fullscreen"},on:{click:function(e){return t.handleAddBoundingBoxClick(r.bboxMark)}}}),t.isNewBboxMarkVisible(a("bboxMark"))?n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":o.bboxMark()},attrs:{"icon-left":"fullscreen-exit"},on:{click:function(t){return r.bboxMark()}}}):t._e()],1)]}}])})},Qt=[];function te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?te(Object(n),!0).forEach((function(e){Object(z["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ne={data:function(){return{bboxAddedCallback:void 0,featureMarkAddedCallback:void 0}},name:"MenuBubble",props:["editor"],components:{EditorMenuBubble:kt["d"]},computed:ee({},Object(o["c"])({bboxBeingAdded:function(t){return t.bboxBeingAdded},featureBeingAdded:function(t){return t.featureBeingAdded}})),watch:{bboxBeingAdded:function(t){t&&t.active&&t.bounds&&this.bboxAddedCallback&&(this.bboxAddedCallback(t.bounds),this.bboxAddedCallback=void 0,this.$store.commit(p,{active:!1,position:void 0}))},featureBeingAdded:function(t){t&&t.active&&t.position&&this.featureMarkAddedCallback&&(this.featureMarkAddedCallback(t.position),this.featureMarkAddedCallback=void 0,this.$store.commit(y,{active:!1,position:void 0}))}},methods:{isNewFeatureMarkButtonVisible:function(t){return t&&t[Y]},isNewBboxMarkVisible:function(t){return t&&t[W]},handleAddFeatureMarkClick:function(t){this.featureMarkAddedCallback=t,this.$store.commit(y,{active:!0,position:void 0})},handleRemoveFeatureMarkClick:function(t){this.$store.commit(j,void 0),t()},handleAddBoundingBoxClick:function(t){this.bboxAddedCallback=t,this.$store.commit(p,{active:!0,bounds:void 0})}}},re=ne,ae=(n("8715"),Object(P["a"])(re,Kt,Qt,!1,null,"1c7012b5",null)),oe=ae.exports;function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach((function(e){Object(z["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ce={name:"CsEditor",components:{EditorContent:kt["b"],MenuBubble:oe,MenuBar:Zt},data:function(){return{contentPlaceholder:"Můžete začít psát...",editor:void 0,keepInBounds:!0}},computed:se({},Object(o["c"])({editable:function(t){return t.editable},highlightedLatLng:function(t){return t.highlightedLatLng}}),{storyName:{get:function(){return this.$store.state.story.name},set:function(t){this.$store.commit(C,t)}}}),watch:{highlightedLatLng:function(){this.scrollToHighlightedLatLng()}},mounted:function(){this.editor=this.$createEditor()},methods:{scrollToHighlightedLatLng:function(){if(this.highlightedLatLng){var t=this.highlightedLatLng,e=t.lat,n=t.lng,r=document.querySelector("[".concat(Y,"='").concat(e,"'], [").concat(Z,"='").concat(n,"']"));this.$scrollTo(r,void 0,{container:document.querySelector(".editor"),offset:-50})}},$createEditor:function(){var t=this;return new kt["a"]({editable:this.editable,extensions:[new Mt,new Tt,new _t["a"]({levels:[2,3,4]})],content:this.$store.state.story.text||this.contentPlaceholder,onUpdate:function(e){t.$store.commit(w,e)}})}},beforeDestroy:function(){this.editor.destroy()}},le=ce,ue=(n("116c"),Object(P["a"])(le,Ot,jt,!1,null,null,null)),de=ue.exports,be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-6 has-padding-0"},[n("div",{staticClass:"cs-map"},[n("div",{attrs:{id:"cs-map-container"}},[n("l-map",{ref:"csmap",attrs:{center:t.highlightedLatLng||t.mapOptions.center,zoom:t.mapOptions.zoom},on:{click:function(e){return t.handleMapClick(e.latlng)},mousedown:function(e){return t.handleMapMouseDown(e.latlng)}}},[n("l-control",{staticClass:"leaflet-bar leaflet-control",attrs:{position:"topleft"}},[t.editable?n("cs-track-upload-button",{on:t._d({},[t.TRACK_FILE_UPLOAD_EVENT,function(e){return t.handleFileUpload(e)}])}):t._e()],1),n("l-tile-layer",{attrs:{url:t.mapOptions.baseLayer}}),n("l-tile-layer",{attrs:{url:t.mapOptions.hikingOverlay,"layer-type":"overlay",opacity:.7}}),n("l-tile-layer",{attrs:{url:t.mapOptions.labelsOverlay,"layer-type":"overlay"}}),t.track?n("l-geo-json",{ref:"cstrack",attrs:{geojson:t.track,options:t.trackOptions.style.plain},on:{ready:function(e){return t.handleTrackReady(e)}}}):t._e(),t._l(t.bboxes,(function(e){return n("l-rectangle",{key:e.id,attrs:{bounds:e.bounds,"l-style":t.bboxOptions.selected.style}})})),t._l(t.featuresWithoutHighlighted,(function(e,r){return n("l-circle-marker",{key:r,attrs:{color:t.markerOptions.style.plain.color,"fill-color":t.markerOptions.style.plain.color,"fill-opacity":t.markerOptions.style.plain.fillOpacity,latLng:e,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}})})),t.highlightedLatLng?n("l-circle-marker",{attrs:{color:t.markerOptions.style.highlighted.color,"fill-color":t.markerOptions.style.highlighted.color,"fill-opacity":t.markerOptions.style.highlighted.fillOpacity,latLng:t.highlightedLatLng,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}}):t._e()],2)],1)])])},fe=[],he=n("ea97"),pe=n("2253c"),me=n("044a"),ge=n("2699"),ve=n("a40a"),ye=n("fb8e"),Oe={bounds:void 0,center:[50,19],baseLayer:"https://api.mapbox.com/styles/v1/cartostory/cjugqcypf27581gnry4y59lxy/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",hikingOverlay:"http://tile.mtbmap.cz/overlay_hiking/{z}/{x}/{y}.png",labelsOverlay:"https://api.mapbox.com/styles/v1/cartostory/cjugqfe8r1lhh1ftgrmr7v9zj/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",zoom:8,edgeMarker:void 0},je={style:{common:{radius:8,weight:1.5},highlighted:{color:"#F56C6C",opacity:1,fillOpacity:.4},inBbox:{color:"#42b983",fillOpacity:.5},plain:{color:"#3185fc",fillOpacity:.5},edge:{icon:{iconUrl:"../../node_modules/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]}}}},ke={plain:{style:{color:"#5a5a66",fillOpacity:0,dashArray:"5",weight:2}},hovered:{style:{color:"#5a5a66",fillColor:"#5a5a66",dashArray:"5",weight:2}},selected:{style:{color:"#42b983",fillColor:"#42b983",fillOpacity:0,dashArray:"5",weight:2}}},_e={style:{plain:{color:"#5a5a66",dashArray:"6"},inBbox:{color:"#42b983",dashArray:"6"}}},xe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("file-reader",{staticStyle:{height:"30px",width:"30px","line-height":"30px"},attrs:{accept:".json",output:"text"},on:{"reader-load":t.handleFileUpload},scopedSlots:t._u([{key:"reader",fn:function(e){return[n("b-button",{staticClass:"file-upload-button",attrs:{title:"Nahrát soubor trasy",size:"is-small","icon-left":"cloud-upload"},on:{click:function(e){return t.$refs.fileReader.click()}}}),n("input",{ref:"fileReader",staticStyle:{visibility:"hidden"},attrs:{type:"file",accept:e.accept},on:{change:e.onchange}})]}}])})},Ce=[],we=n("5112"),Ae=n.n(we),Ee={name:"CsTrackUploadButton",components:{FileReader:Ae.a},methods:{handleFileUpload:function(t){try{this.$emit(et,t&&JSON.parse(t.data))}catch(e){this.$store.commit(g,{title:"Selhalo nahrání trasy",message:"Trasu se nepodařilo nahrát. Soubor pravděpodobně není validní."})}}}},Se=Ee,Le=(n("d51c"),Object(P["a"])(Se,xe,Ce,!1,null,"6f11a710",null)),Pe=Le.exports;function De(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Me(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?De(Object(n),!0).forEach((function(e){Object(z["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n("6cc5"),n("20d6b");var Be={name:"CsMap",components:{CsTrackUploadButton:Pe,LCircleMarker:he["a"],LControl:pe["a"],LGeoJson:me["a"],LMap:ge["a"],LTileLayer:ve["a"],LRectangle:ye["a"]},data:function(){return{STORY_LINK_CLICK_EVENT:tt,TRACK_FILE_UPLOAD_EVENT:et,addFeatureMark:void 0,bboxOptions:ke,drawControl:void 0,markerOptions:je,mapOptions:Oe,trackOptions:_e,bboxBounds:[void 0,void 0]}},computed:Me({},Object(o["c"])({addBoundingBoxCallback:function(t){return t.addBoundingBoxCallback},bboxBeingAdded:function(t){return t.bboxBeingAdded},editable:function(t){return t.editable},featureBeingAdded:function(t){return t.featureBeingAdded},highlightedLatLng:function(t){return t.highlightedLatLng},track:function(t){return t.story.track}}),{},Object(o["b"])(["bboxes","features","featuresWithoutHighlighted"])),methods:{handleTrackReady:function(t){this.$refs.csmap.mapObject.fitBounds(t.getBounds())},handleFeatureClick:function(t){var e,n=t.latlng,r=n.lat,a=n.lng,o=document.querySelector("[data-cs-lat='".concat(r,"'], [data-cs-lng='").concat(a,"']"));o&&this.$store.commit(j,(e={},Object(z["a"])(e,Y,o.getAttribute([Y])),Object(z["a"])(e,Z,o.getAttribute([Z])),e))},handleMapClick:function(t){var e;if(this.featureBeingAdded.active){var n=(e={},Object(z["a"])(e,Y,t.lat),Object(z["a"])(e,Z,t.lng),e);this.$store.commit(y,{active:!0,position:n})}},handleMapMouseDown:function(){if(this.bboxBeingAdded.active){var t=this.$refs.csmap.mapObject;window.L.drawLocal.draw.handlers.rectangle.tooltip.start="",window.L.drawLocal.draw.handlers.simpleshape.tooltip.end="",new window.L.Draw.Rectangle(t,{showArea:!1,shapeOptions:this.bboxOptions.plain.style}).enable(),t.off(window.L.Draw.Event.CREATED),t.on(window.L.Draw.Event.CREATED,this.$handleCreateRectangle)}},handleFileUpload:function(t){this.$store.commit(E,t)},$handleCreateRectangle:function(t){var e=t.layer.getBounds(),n=e.getNorthWest(),r=e.getSouthEast(),a=[[n.lat,n.lng],[r.lat,r.lng]];this.$store.commit(p,{active:!0,bounds:a})}}},$e=Be,Ne=(n("eb8d"),Object(P["a"])($e,be,fe,!1,null,"6d3c9a8a",null)),Te=Ne.exports,Re={name:"story-screen",components:{CsEditor:de,CsMap:Te},data:function(){return{ready:!1}},computed:{editable:function(){return this.$store.state.editable}},mounted:function(){this.ready="/story/create"===this.$router.currentRoute.path}},Ue=Re,ze=(n("d936"),Object(P["a"])(Ue,vt,yt,!1,null,"286468d7",null)),Fe=ze.exports,Ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mt-2"},[t._v("Cartostory")]),n("div",{staticClass:"card has-padding-1"},[n("div",{staticClass:"card-content"},[t.availableStories.length>0?n("b-field",{attrs:{label:"Nahrát příběh"}},[n("b-select",{attrs:{placeholder:"Příběh",expanded:""},on:{input:t.handleStorySelect}},t._l(t.availableStories,(function(e){return n("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.name)+"\n            ")])})),0)],1):t._e(),n("b-field",{attrs:{label:"URL příběhu"}},[n("b-input",{attrs:{type:"text",expanded:""},model:{value:t.storyUrl,callback:function(e){t.storyUrl=e},expression:"storyUrl"}})],1),n("b-button",{attrs:{disabled:t.disabledSubmit,type:"is-primary"},on:{click:t.handleSubmit}},[t._v("Načíst")])],1)])])])])},He=[],Je=(n("7514"),n("f788")),Ge=n.n(Je);function Ve(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ve(Object(n),!0).forEach((function(e){Object(z["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var We={name:"LoadStoryForm",data:function(){return{currentStory:void 0}},computed:qe({},Object(o["c"])({availableStories:function(t){return t.availableStories},storyName:function(t){return t.story.name},storyText:function(t){return t.story.text}}),{disabledSubmit:function(){return!this.storyUrl},storyUrl:{get:function(){return this.$store.state.storyUrl},set:function(t){this.$store.commit(A,t)}}}),methods:{handleSubmit:function(){var t=Object(U["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("loadStory");case 3:e=Ge()(this.storyName).toLowerCase(),this.$router.push("/story/read/".concat(e)),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$store.commit(g,{title:"Příběh se nepodařilo nahrát",message:"Zkontrolujte jeho adresu."});case 10:return t.prev=10,this.$store.commit(k,!1),t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,7,10,13]])})));function e(){return t.apply(this,arguments)}return e}(),handleStorySelect:function(t){var e=this.availableStories.find((function(e){return e.name===t}));e&&(this.storyUrl=e.storyUrl)}}},Xe=We,Ye=Object(P["a"])(Xe,Ie,He,!1,null,"6706dcd3",null),Ze=Ye.exports;a["a"].use(R["a"]);var Ke=[{path:"/",component:gt},{path:"/story/read/:title",component:Fe,beforeEnter:function(t,e,n){dt.commit(v,!1),dt.state.storyUrl?n():n("/story/load")}},{path:"/story/load",component:Ze},{path:"/story/create",component:Fe,beforeEnter:function(t,e,n){dt.commit(v,!0),n()}}],Qe=new R["a"]({mode:"history",base:"/",routes:Ke});Qe.beforeEach((function(t,e,n){dt.commit(k,!0),n()})),Qe.afterEach((function(){dt.commit(k,!1)}));var tn=Qe;n("6cc5"),a["a"].config.productionTip=!1,a["a"].use(r["a"]),a["a"].use(s.a),a["a"].use(l.a),a["a"].use(o["a"]),new a["a"]({store:dt,router:tn,render:function(t){return t(T)}}).$mount("#js-cartostory")},6297:function(t,e,n){},"6a2b":function(t,e,n){"use strict";var r=n("33f4"),a=n.n(r);a.a},8715:function(t,e,n){"use strict";var r=n("d8c3"),a=n.n(r);a.a},"9b7d":function(t,e,n){},"9e12":function(t,e,n){},a41b:function(t,e,n){},ba4b:function(t,e,n){"use strict";var r=n("dbab"),a=n.n(r);a.a},d51c:function(t,e,n){"use strict";var r=n("6297"),a=n.n(r);a.a},d8c3:function(t,e,n){},d936:function(t,e,n){"use strict";var r=n("fee2"),a=n.n(r);a.a},dbab:function(t,e,n){},eb8d:function(t,e,n){"use strict";var r=n("9b7d"),a=n.n(r);a.a},fee2:function(t,e,n){}});
//# sourceMappingURL=app.1559b711.js.map