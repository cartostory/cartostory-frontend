(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"116c":function(t,e,n){"use strict";var r=n("9e12"),a=n.n(r);a.a},1347:function(t,e,n){},"33f4":function(t,e,n){},"541e":function(t,e,n){"use strict";var r=n("9ef9"),a=n.n(r);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("289d"),a=n("a026"),o=n("2f62"),i=n("85ff"),s=n.n(i),c=n("f13c"),l=n.n(c),u=(n("f5df"),n("a41b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section",attrs:{id:"js-app"}},[n("router-view"),n("cs-notification"),n("b-loading",{attrs:{"is-full-page":!0,active:t.loading},on:{"update:active":function(e){t.loading=e}}})],1)}),d=[],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},h=[],b=(n("ac6a"),"REMOVE_ERROR"),p="UPDATE_BOUNDING_BOX_CALLBACK",m="UPDATE_ERRORS",y="UPDATE_EDITABLE",g="UPDATE_FEATURE_MARK_CALLBACK",v="UPDATE_HIGHLIGHTED_BBOX",O="UPDATE_HIGHLIGHTED_LAT_LNG",k="UPDATE_LOADING",_="UPDATE_MAP_CENTER",j="UPDATE_STORY",C="UPDATE_STORY_NAME",x="UPDATE_STORY_TEXT",w="UPDATE_STORY_URL",E="UPDATE_TRACK",L={name:"CsNotification",computed:{errors:function(){var t=this;return this.$store.state.errors.forEach((function(e){t.$buefy.snackbar.open({indefinite:!0,position:"is-top-right",type:"is-danger",message:"<strong>".concat(e.title,"</strong><br/><p>").concat(e.message,"</p>"),onAction:function(){t.$store.commit(b,e)}}),t.$store.commit(b,e)})),this.$store.state.errors}},watch:{errors:function(){return this.errors}}},M=L,A=n("2877"),S=Object(A["a"])(M,f,h,!1,null,null,null),D=S.exports,$={name:"app",components:{CsNotification:D},computed:{loading:function(){return this.$store.state.loading}}},N=$,T=Object(A["a"])(N,u,d,!1,null,null,null),B=T.exports,P=n("8c4f"),R=(n("96cf"),n("3b8d")),U=n("bd86"),F=(n("c5f6"),n("5df2"),n("75fc")),I=(n("20d6"),n("bc3a")),z=n.n(I),V=n("89c7"),H=n.n(V),J=n("c2d0"),G=n("7e8c"),K=(n("28a5"),"data-cs-bbox"),q=rt(K),X="data-cs-lat",W="data-cs-lng",Y=rt(X),Z=rt(W),Q="mark-click",tt="add-bounding-box",et="add-feature-mark",nt="track-file-upload";function rt(t){return t.split("-").map((function(t,e){return e>0?t.slice(0,1).toUpperCase()+t.slice(1):t})).join("")}var at,ot=function(t){return t[t.length-1]},it=function(t){return function(e,n){e[t]=n}},st=function(t){return function(e,n){var r=t.slice(0,-1).reduce((function(e,n,r){return n in e||(e[n]="number"===typeof t[r+1]?[]:{}),e[n]}),e);r[ot(t)]=n}};a["a"].use(o["a"]);var ct={editable:!1,errors:[],loading:!1,storyUrl:void 0,story:{name:void 0,text:void 0,track:void 0},addBoundingBoxCallback:void 0,addFeatureMarkCallback:void 0,availableStories:[],highlightedBbox:void 0,highlightedLatLng:void 0},lt=(at={},Object(U["a"])(at,b,(function(t,e){var n=t.errors.findIndex((function(t){return t.title===e.title&&t.message===e.message}));n>-1&&t.errors.splice(n,1)})),Object(U["a"])(at,p,it("addBoundingBoxCallback")),Object(U["a"])(at,y,it("editable")),Object(U["a"])(at,m,(function(t,e){t.errors=[].concat(Object(F["a"])(t.errors),[e])})),Object(U["a"])(at,g,it("addFeatureMarkCallback")),Object(U["a"])(at,v,(function(t,e){t.highlightedBbox=[{lat:e[0][0],lng:e[0][1]},{lat:e[1][0],lng:e[1][1]}]})),Object(U["a"])(at,O,(function(t,e){t.highlightedLatLng=e?{lat:Number.parseFloat(e[X]),lng:Number.parseFloat(e[W])}:void 0})),Object(U["a"])(at,k,it("loading")),Object(U["a"])(at,_,st(["map","center"])),Object(U["a"])(at,j,it("story")),Object(U["a"])(at,C,st(["story","name"])),Object(U["a"])(at,x,st(["story","text"])),Object(U["a"])(at,w,it("storyUrl")),Object(U["a"])(at,E,st(["story","track"])),at),ut={updateTrack:function(t,e){var n=t.commit;n(E,e)},updateStoryText:function(t,e){var n=t.commit;n(x,e)},loadStory:function(){var t=Object(R["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,r=e.state,n(k,!0),t.next=4,z.a.get(r.storyUrl);case 4:a=t.sent,n(j,a.data);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},dt={content:function(t){var e;return e=t.story.text&&t.story.text.state?t.story.text.state.doc.content:t.story.text&&t.story.text.content,e&&JSON.parse(JSON.stringify(e))},bboxes:function(t,e){var n=[],r=e.content;if(r){var a=Object(G["a"])(r,K);n=Object(J["a"])(a,(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t})).map((function(t){return JSON.parse(t)})).map((function(t,e){return{id:e,bounds:[[t[0][0],t[0][1]],[t[1][0],t[1][1]]]}}))}return n},features:function(t,e){var n=[],r=e.content;if(r){var a=Object(J["a"])(Object(G["a"])(r,[X,W]),(function(t){return t}),{leavesOnly:!0}).filter((function(t){return null!==t}));n=H()(a,2).map((function(t){return{lat:t[0],lng:t[1]}}))}return n},featuresWithoutHighlighted:function(t,e){if(!t.highlightedLatLng)return e.features;var n=t.highlightedLatLng,r=n.lat,a=n.lng;return e.features.filter((function(t){return t.lat!==r&&t.lng!==a}))}},ft=new o["a"].Store({strict:!0,getters:dt,state:ct,mutations:lt,actions:ut}),ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"hero is-fullheight"},[n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[t._m(0),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 section-left has-pb-0"},[n("h2",{staticClass:"title is-2 has-text-weight-normal has-text-centered has-mb-2"},[t._v("Napsat příběh")]),n("p",[t._v("Chcete napsat svůj vlastní příběh? Z prázdnin, dovolené nebo jen zajímavého sobotního\n                výletu?")]),n("b-button",{on:{click:function(e){return t.$router.push("/story/create")}}},[t._v("Chci psát")])],1),n("div",{staticClass:"column is-6 section-right has-pb-0"},[n("h2",{staticClass:"title is-2 has-text-weight-normal has-text-centered has-mb-2"},[t._v("Číst příběh")]),n("p",[t._v("Váš kamarád nebo příbuzný napsal příběh a poslal vám jeho adresu? Můžete si ho přečíst.")]),n("b-button",{on:{click:function(e){return t.$router.push("/story/load")}}},[t._v("Chci číst")])],1)])])])])])])},bt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mb-1"},[t._v("Cartostory")])])])}],pt={name:"Landing"},mt=pt,yt=(n("6a2b"),Object(A["a"])(mt,ht,bt,!1,null,"40225d4e",null)),gt=yt.exports,vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid story-form"},[n("div",{staticClass:"columns has-margin-0",staticStyle:{height:"100vh"}},[n("cs-map"),n("div",{staticStyle:{display:"flex","flex-direction":"column",width:"100%"}},[t.$store.state.story.text||t.ready?n("cs-editor",{on:t._d({},[t.ADD_FEATURE_MARK_EVENT,function(e){return t.handleAddFeatureMarkClick(e)},t.ADD_BOUNDING_BOX_EVENT,function(e){return t.handleAddBoundingBoxClick(e)}])}):t._e()],1)],1)])},Ot=[],kt={bounds:void 0,center:[50,19],baseLayer:"https://api.mapbox.com/styles/v1/cartostory/cjugqcypf27581gnry4y59lxy/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",hikingOverlay:"http://tile.mtbmap.cz/overlay_hiking/{z}/{x}/{y}.png",labelsOverlay:"https://api.mapbox.com/styles/v1/cartostory/cjugqfe8r1lhh1ftgrmr7v9zj/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",zoom:8,edgeMarker:void 0},_t={style:{common:{radius:8,weight:1.5},highlighted:{color:"#F56C6C",opacity:1,fillOpacity:.4},inBbox:{color:"#42b983",fillOpacity:.5},plain:{color:"#3185fc",fillOpacity:.5},edge:{icon:{iconUrl:"../../node_modules/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]}}}},jt={plain:{style:{color:"#5a5a66",fillOpacity:0,dashArray:"5",weight:2}},hovered:{style:{color:"#5a5a66",fillColor:"#5a5a66",dashArray:"5",weight:2}},selected:{style:{color:"#42b983",fillColor:"#42b983",fillOpacity:0,dashArray:"5",weight:2}}},Ct={style:{plain:{color:"#5a5a66",dashArray:"6"},inBbox:{color:"#42b983",dashArray:"6"}}},xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-12 has-padding-0 story-text"},[n("div",{staticClass:"story-text__content"},[t.editable?n("form",{staticClass:"has-mt-1"},[n("b-field",[n("b-input",{attrs:{"custom-class":"story-title-input",placeholder:"Název příběhu",size:"is-large"},model:{value:t.storyName,callback:function(e){t.storyName=e},expression:"storyName"}})],1)],1):t._e(),t.editable?t._e():n("h1",{staticClass:"story-title-input has-mt-1"},[t._v(t._s(t.storyName))]),t.editable?n("menu-bar",{attrs:{editor:t.editor}}):t._e(),t.editable?n("menu-bubble",{attrs:{editor:t.editor}}):t._e(),n("editor-content",{staticClass:"editor",class:{editable:this.editable},staticStyle:{flex:"1",overflow:"auto"},attrs:{editor:t.editor}})],1)])},wt=[],Et=(n("8e6e"),n("456d"),n("7f7f"),n("cd42")),Lt=n("f23d"),Mt=(n("6b54"),n("2397"),n("d225")),At=n("b0b4"),St=n("308d"),Dt=n("6bb5"),$t=n("4e2b"),Nt=n("a9de");function Tt(t){return function(){var e,n=Object(Dt["a"])(t);if(Bt()){var r=Object(Dt["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(St["a"])(this,e)}}function Bt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var Pt="a",Rt=function(t){Object($t["a"])(n,t);var e=Tt(n);function n(){return Object(Mt["a"])(this,n),e.apply(this,arguments)}return Object(At["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n=t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]];return Object(Nt["r"])(e,Object(U["a"])({},K,JSON.stringify(n)))}}},{key:"name",get:function(){return"bboxMark"}},{key:"schema",get:function(){return{attrs:Object(U["a"])({},K,{default:null}),parseDOM:[{tag:Pt,getAttrs:function(t){return Object(U["a"])({},K,t.dataset[K])}}],toDOM:function(t){return[Pt,Object(U["a"])({},K,t.attrs[K]),0]}}}},{key:"view",get:function(){return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t=JSON.parse(this[q]);this.$store.commit(v,t)}},computed:Object(U["a"])({isHighlighted:function(){if(!this.$store.state.highlightedBbox)return!1;var t=this.$store.state.highlightedBbox;t.lat,t.lng;return!0}},q,{get:function(){return this.node.attrs[K]},set:function(t){this.updateAttrs(Object(U["a"])({},K,t))}}),template:"\n        <a\n          :class=\"{'is-highlighted': isHighlighted}\"\n          :".concat(K,'="').concat(q,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(Et["f"]);function Ut(t){return function(){var e,n=Object(Dt["a"])(t);if(Ft()){var r=Object(Dt["a"])(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(St["a"])(this,e)}}function Ft(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var It="a",zt=function(t){Object($t["a"])(n,t);var e=Ut(n);function n(){return Object(Mt["a"])(this,n),e.apply(this,arguments)}return Object(At["a"])(n,[{key:"commands",value:function(t){var e=t.type;return function(t){var n;return Object(Nt["r"])(e,(n={},Object(U["a"])(n,X,t&&t[X]),Object(U["a"])(n,W,t&&t[W]),n))}}},{key:"name",get:function(){return"featureMark"}},{key:"schema",get:function(){var t;return{attrs:(t={},Object(U["a"])(t,X,{default:null}),Object(U["a"])(t,W,{default:null}),t),parseDOM:[{tag:It,getAttrs:function(t){var e;return e={},Object(U["a"])(e,X,t.dataset[X]),Object(U["a"])(e,W,t.dataset[W]),e}}],toDOM:function(t){var e;return[It,(e={},Object(U["a"])(e,X,t.attrs[X]),Object(U["a"])(e,W,t.attrs[W]),e),0]}}}},{key:"view",get:function(){var t;return{props:["node","updateAttrs","view"],methods:{handleClick:function(){var t,e=(t={},Object(U["a"])(t,X,this[Y]),Object(U["a"])(t,W,this[Z]),t);this.$store.commit(O,e)}},computed:(t={isHighlighted:function(){if(!this.$store.state.highlightedLatLng)return!1;var t=this.$store.state.highlightedLatLng,e=t.lat,n=t.lng;return e===this[Y]&&n===this[Z]}},Object(U["a"])(t,Y,{get:function(){return this.node.attrs[X]},set:function(t){this.updateAttrs(Object(U["a"])({},X,t))}}),Object(U["a"])(t,Z,{get:function(){return this.node.attrs[W]},set:function(t){this.updateAttrs(Object(U["a"])({},W,t))}}),t),template:"\n        <a\n          :".concat(W,'="').concat(Z,'"\n          :').concat(X,'="').concat(Y,'"\n          @click="handleClick()"\n        >\n        </a>\n      ')}}}]),n}(Et["f"]),Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bar",{staticClass:"has-mt-1",staticStyle:{background:"white"},attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.isActive;return[n("div",{staticClass:"editor-menu-bar buttons"},[n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:2})},attrs:{title:"Nadpis 1. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:2})}}},[t._v("\n      H1\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:3})},attrs:{title:"Nadpis 2. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:3})}}},[t._v("\n      H2\n    ")]),n("b-button",{staticClass:"menubar__button",class:{"is-active":a.heading({level:4})},attrs:{title:"Nadpis 3. úrovně",size:"is-small"},on:{click:function(t){return r.heading({level:4})}}},[t._v("\n      H3\n    ")]),n("b-button",{staticClass:"menubar__button",staticStyle:{"margin-left":"auto"},attrs:{title:"Uložit příběh",size:"is-small",type:"is-primary"},on:{click:t.handleSave}},[t._v("Uložit\n    ")])],1)]}}])})},Ht=[],Jt={name:"MenuBar",components:{EditorMenuBar:Et["c"]},props:["editor"],methods:{handleSave:function(){var t={name:this.$store.state.story.name,text:this.$store.state.story.text,track:this.$store.state.story.track};console.log("handleSave",t)}}},Gt=Jt,Kt=Object(A["a"])(Gt,Vt,Ht,!1,null,null,null),qt=Kt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":!0},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.commands,a=e.getMarkAttrs,o=e.isActive,i=e.menu;return[n("div",{staticClass:"menububble",class:{"is-active":i.isActive},style:"left: "+i.left+"px; bottom: "+i.bottom+"px;"},[t.isNewFeatureMarkButtonVisible(a("featureMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__mark",class:{"is-active":o.featureMark()},attrs:{"icon-left":"map-marker-plus"},on:{click:function(e){return t.handleAddFeatureMarkClick(r.featureMark)}}}),t.isNewFeatureMarkButtonVisible(a("featureMark"))?n("b-button",{staticClass:"menububble__button",class:{"is-active":o.featureMark()},attrs:{"icon-left":"map-marker-minus"},on:{click:function(e){return t.handleRemoveFeatureMarkClick(r.featureMark)}}}):t._e(),t.isNewBboxMarkVisible(a("bboxMark"))?t._e():n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":o.bboxMark()},attrs:{"icon-left":"fullscreen"},on:{click:function(e){return t.handleAddBoundingBoxClick(r.bboxMark)}}}),t.isNewBboxMarkVisible(a("bboxMark"))?n("b-button",{staticClass:"menububble__button menububble__button__bbox",class:{"is-active":o.bboxMark()},attrs:{"icon-left":"fullscreen-exit"},on:{click:function(t){return r.bboxMark()}}}):t._e()],1)]}}])})},Wt=[],Yt={name:"MenuBubble",props:["editor"],components:{EditorMenuBubble:Et["d"]},methods:{isNewFeatureMarkButtonVisible:function(t){return t&&t[X]},isNewBboxMarkVisible:function(t){return t&&t[K]},handleAddFeatureMarkClick:function(t){this.$parent.$emit(et,t)},handleRemoveFeatureMarkClick:function(t){this.$store.commit(O,void 0),t()},handleAddBoundingBoxClick:function(t){this.$parent.$emit(tt,t)}}},Zt=Yt,Qt=(n("c34e"),Object(A["a"])(Zt,Xt,Wt,!1,null,"84d85270",null)),te=Qt.exports;function ee(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ne(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ee(Object(n),!0).forEach((function(e){Object(U["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var re={name:"CsEditor",components:{EditorContent:Et["b"],MenuBubble:te,MenuBar:qt},data:function(){return{contentPlaceholder:"Můžete začít psát...",editor:void 0,keepInBounds:!0}},computed:ne({},Object(o["c"])({editable:function(t){return t.editable},highlightedLatLng:function(t){return t.highlightedLatLng}}),{storyName:{get:function(){return this.$store.state.story.name},set:function(t){this.$store.commit(C,t)}}}),watch:{highlightedLatLng:function(){this.scrollToHighlightedLatLng()}},mounted:function(){this.editor=this.$createEditor()},methods:{scrollToHighlightedLatLng:function(){if(this.highlightedLatLng){var t=this.highlightedLatLng,e=t.lat,n=t.lng,r=document.querySelector("[".concat(X,"='").concat(e,"'], [").concat(W,"='").concat(n,"']"));this.$scrollTo(r,void 0,{container:document.querySelector(".editor"),offset:-50})}},$createEditor:function(){var t=this;return new Et["a"]({editable:this.editable,extensions:[new Rt,new zt,new Lt["a"]({levels:[2,3,4]})],content:this.$store.state.story.text||this.contentPlaceholder,onUpdate:function(e){t.$store.commit(x,e)}})}},beforeDestroy:function(){this.editor.destroy()}},ae=re,oe=(n("116c"),Object(A["a"])(ae,xt,wt,!1,null,null,null)),ie=oe.exports,se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"column is-6 has-padding-0"},[n("div",{staticClass:"cs-map"},[n("div",{attrs:{id:"cs-map-container"}},[n("l-map",{ref:"csmap",attrs:{center:t.highlightedLatLng||t.mapOptions.center,zoom:t.mapOptions.zoom},on:{click:function(e){return t.handleMapClick(e.latlng)},mousedown:function(e){return t.handleMapMouseDown(e.latlng)}}},[n("l-control",{staticClass:"leaflet-bar leaflet-control",attrs:{position:"topleft"}},[t.editable?n("cs-track-upload-button",{on:t._d({},[t.TRACK_FILE_UPLOAD_EVENT,function(e){return t.handleFileUpload(e)}])}):t._e()],1),n("l-tile-layer",{attrs:{url:t.mapOptions.baseLayer}}),n("l-tile-layer",{attrs:{url:t.mapOptions.hikingOverlay,"layer-type":"overlay",opacity:.7}}),n("l-tile-layer",{attrs:{url:t.mapOptions.labelsOverlay,"layer-type":"overlay"}}),t.track?n("l-geo-json",{ref:"cstrack",attrs:{geojson:t.track,options:t.trackOptions.style.plain},on:{ready:function(e){return t.handleTrackReady(e)}}}):t._e(),t._l(t.bboxes,(function(e){return n("l-rectangle",{key:e.id,attrs:{bounds:e.bounds,"l-style":t.bboxOptions.selected.style}})})),t._l(t.featuresWithoutHighlighted,(function(e,r){return n("l-circle-marker",{key:r,attrs:{color:t.markerOptions.style.plain.color,"fill-color":t.markerOptions.style.plain.color,"fill-opacity":t.markerOptions.style.plain.fillOpacity,latLng:e,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}})})),t.highlightedLatLng?n("l-circle-marker",{attrs:{color:t.markerOptions.style.highlighted.color,"fill-color":t.markerOptions.style.highlighted.color,"fill-opacity":t.markerOptions.style.highlighted.fillOpacity,latLng:t.highlightedLatLng,radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:t.handleFeatureClick}}):t._e()],2)],1)])])},ce=[],le=n("ea97"),ue=n("2253c"),de=n("044a"),fe=n("2699"),he=n("a40a"),be=n("fb8e"),pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("file-reader",{staticStyle:{height:"30px",width:"30px","line-height":"30px"},attrs:{accept:".json",output:"text"},on:{"reader-load":t.handleFileUpload},scopedSlots:t._u([{key:"reader",fn:function(e){return[n("b-button",{staticClass:"file-upload-button",attrs:{title:"Nahrát soubor trasy",size:"is-small","icon-left":"cloud-upload"},on:{click:function(e){return t.$refs.fileReader.click()}}}),n("input",{ref:"fileReader",staticStyle:{visibility:"hidden"},attrs:{type:"file",accept:e.accept},on:{change:e.onchange}})]}}])})},me=[],ye=n("5112"),ge=n.n(ye),ve={name:"CsTrackUploadButton",components:{FileReader:ge.a},methods:{handleFileUpload:function(t){try{this.$emit(nt,t&&JSON.parse(t.data))}catch(e){this.$store.commit(m,{title:"Selhalo nahrání trasy",message:"Trasu se nepodařilo nahrát. Soubor pravděpodobně není validní."})}}}},Oe=ve,ke=(n("d51c"),Object(A["a"])(Oe,pe,me,!1,null,"6f11a710",null)),_e=ke.exports;function je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?je(Object(n),!0).forEach((function(e){Object(U["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n("6cc5"),n("20d6b");var xe={name:"CsMap",components:{CsTrackUploadButton:_e,LCircleMarker:le["a"],LControl:ue["a"],LGeoJson:de["a"],LMap:fe["a"],LTileLayer:he["a"],LRectangle:be["a"]},data:function(){return{STORY_LINK_CLICK_EVENT:Q,TRACK_FILE_UPLOAD_EVENT:nt,addFeatureMark:void 0,bboxOptions:jt,drawControl:void 0,markerOptions:_t,mapOptions:kt,trackOptions:Ct,bboxBounds:[void 0,void 0]}},computed:Ce({},Object(o["c"])({addBoundingBoxCallback:function(t){return t.addBoundingBoxCallback},addFeatureMarkCallback:function(t){return t.addFeatureMarkCallback},editable:function(t){return t.editable},highlightedLatLng:function(t){return t.highlightedLatLng},track:function(t){return t.story.track}}),{},Object(o["b"])(["bboxes","features","featuresWithoutHighlighted"])),methods:{handleTrackReady:function(t){this.$refs.csmap.mapObject.fitBounds(t.getBounds())},handleFeatureClick:function(t){var e,n=t.latlng,r=n.lat,a=n.lng,o=document.querySelector("[data-cs-lat='".concat(r,"'], [data-cs-lng='").concat(a,"']"));o&&this.$store.commit(O,(e={},Object(U["a"])(e,X,o.getAttribute([X])),Object(U["a"])(e,W,o.getAttribute([W])),e))},handleMapClick:function(t){var e;this.addFeatureMarkCallback&&"function"===typeof this.addFeatureMarkCallback&&(this.addFeatureMarkCallback((e={},Object(U["a"])(e,X,t.lat),Object(U["a"])(e,W,t.lng),e)),this.$store.commit(g,void 0))},handleMapMouseDown:function(){if(this.addBoundingBoxCallback){var t=this.$refs.csmap.mapObject;window.L.drawLocal.draw.handlers.rectangle.tooltip.start="",window.L.drawLocal.draw.handlers.simpleshape.tooltip.end="",new window.L.Draw.Rectangle(t,{showArea:!1,shapeOptions:this.bboxOptions.plain.style}).enable(),t.off(window.L.Draw.Event.CREATED),t.on(window.L.Draw.Event.CREATED,this.$handleCreateRectangle)}},handleFileUpload:function(t){this.$store.commit(E,t)},$handleCreateRectangle:function(t){var e=t.layer.getBounds(),n=e.getNorthWest(),r=e.getSouthEast(),a=[[n.lat,n.lng],[r.lat,r.lng]];this.addBoundingBoxCallback(a),this.$store.commit(p,void 0)}}},we=xe,Ee=(n("541e"),Object(A["a"])(we,se,ce,!1,null,"d5b7a2ac",null)),Le=Ee.exports;n("6cc5");var Me={name:"story-screen",components:{CsEditor:ie,CsMap:Le},data:function(){return{storyName:void 0,ready:!1,ADD_BOUNDING_BOX_EVENT:tt,ADD_FEATURE_MARK_EVENT:et,STORY_LINK_CLICK_EVENT:Q,TRACK_FILE_UPLOAD_EVENT:nt,features:[],track:void 0,trackBounds:void 0,addFeatureMark:void 0,markerOptions:_t,mapOptions:kt,trackOptions:Ct}},computed:{editable:function(){return this.$store.state.editable}},mounted:function(){this.ready="/story/create"===this.$router.currentRoute.path},methods:{handleAddFeatureMarkClick:function(t){this.$store.commit(g,t)},handleAddBoundingBoxClick:function(t){this.$store.commit(p,t)}}},Ae=Me,Se=(n("bb45"),Object(A["a"])(Ae,vt,Ot,!1,null,"8c409c74",null)),De=Se.exports,$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-6 is-offset-3"},[n("h1",{staticClass:"title is-1 has-text-weight-normal has-text-centered has-mt-2"},[t._v("Cartostory")]),n("div",{staticClass:"card has-padding-1"},[n("div",{staticClass:"card-content"},[t.availableStories.length>0?n("b-field",{attrs:{label:"Nahrát příběh"}},[n("b-select",{attrs:{placeholder:"Příběh",expanded:""},on:{input:t.handleStorySelect}},t._l(t.availableStories,(function(e){return n("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.name)+"\n            ")])})),0)],1):t._e(),n("b-field",{attrs:{label:"URL příběhu"}},[n("b-input",{attrs:{type:"text",expanded:""},model:{value:t.storyUrl,callback:function(e){t.storyUrl=e},expression:"storyUrl"}})],1),n("b-button",{attrs:{disabled:t.disabledSubmit,type:"is-primary"},on:{click:t.handleSubmit}},[t._v("Načíst")])],1)])])])])},Ne=[],Te=(n("7514"),n("f788")),Be=n.n(Te);function Pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(n),!0).forEach((function(e){Object(U["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ue={name:"LoadStoryForm",data:function(){return{currentStory:void 0}},computed:Re({},Object(o["c"])({availableStories:function(t){return t.availableStories},storyName:function(t){return t.story.name},storyText:function(t){return t.story.text}}),{disabledSubmit:function(){return!this.storyUrl},storyUrl:{get:function(){return this.$store.state.storyUrl},set:function(t){this.$store.commit(w,t)}}}),methods:{handleSubmit:function(){var t=Object(R["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("loadStory");case 3:e=Be()(this.storyName).toLowerCase(),this.$router.push("/story/read/".concat(e)),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$store.commit(m,{title:"Příběh se nepodařilo nahrát",message:"Zkontrolujte jeho adresu."});case 10:return t.prev=10,this.$store.commit(k,!1),t.finish(10);case 13:case"end":return t.stop()}}),t,this,[[0,7,10,13]])})));function e(){return t.apply(this,arguments)}return e}(),handleStorySelect:function(t){var e=this.availableStories.find((function(e){return e.name===t}));e&&(this.storyUrl=e.storyUrl)}}},Fe=Ue,Ie=Object(A["a"])(Fe,$e,Ne,!1,null,"6706dcd3",null),ze=Ie.exports;a["a"].use(P["a"]);var Ve=[{path:"/",component:gt},{path:"/story/read/:title",component:De,beforeEnter:function(t,e,n){ft.commit(y,!1),ft.state.storyUrl?n():n("/story/load")}},{path:"/story/load",component:ze},{path:"/story/create",component:De,beforeEnter:function(t,e,n){ft.commit(y,!0),n()}}],He=new P["a"]({mode:"history",base:"/",routes:Ve});He.beforeEach((function(t,e,n){ft.commit(k,!0),n()})),He.afterEach((function(){ft.commit(k,!1)}));var Je=He;a["a"].config.productionTip=!1,a["a"].use(r["a"]),a["a"].use(s.a),a["a"].use(l.a),a["a"].use(o["a"]),new a["a"]({store:ft,router:Je,render:function(t){return t(B)}}).$mount("#js-cartostory")},6297:function(t,e,n){},"6a2b":function(t,e,n){"use strict";var r=n("33f4"),a=n.n(r);a.a},"9e12":function(t,e,n){},"9ef9":function(t,e,n){},a41b:function(t,e,n){},bb45:function(t,e,n){"use strict";var r=n("1347"),a=n.n(r);a.a},c34e:function(t,e,n){"use strict";var r=n("d45e"),a=n.n(r);a.a},d45e:function(t,e,n){},d51c:function(t,e,n){"use strict";var r=n("6297"),a=n.n(r);a.a}});
//# sourceMappingURL=app.b25e6bab.js.map