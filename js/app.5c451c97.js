(function(t){function e(e){for(var o,i,s=e[0],l=e[1],c=e[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,c||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],o=!0,s=1;s<r.length;s++){var l=r[s];0!==a[l]&&(o=!1)}o&&(n.splice(e--,1),t=i(i.s=r[0]))}return t}var o={},a={app:0},n=[];function i(e){if(o[e])return o[e].exports;var r=o[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=o,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(r,o,function(e){return t[e]}.bind(null,o));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/cartostory-frontend/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},"501e":function(t,e,r){"use strict";var o=r("7e5f"),a=r.n(o);a.a},"56d7":function(t,e,r){"use strict";r.r(e);r("1f1a"),r("450d");var o=r("4e4b"),a=r.n(o),n=(r("7a0f"),r("0f6c")),i=r.n(n),s=(r("6611"),r("e772")),l=r.n(s),c=(r("de31"),r("c69e")),u=r.n(c),d=(r("10cb"),r("f3ad")),f=r.n(d),h=(r("eca7"),r("3787")),p=r.n(h),b=(r("425f"),r("4105")),m=r.n(b),y=(r("adec"),r("3d2d")),g=r.n(y),v=(r("f4f9"),r("c2cc")),k=r.n(v),x=(r("1951"),r("eedf")),O=r.n(x),S=(r("cadf"),r("551c"),r("f751"),r("097d"),r("2b0e")),_=r("2f62"),U=r("85ff"),w=r.n(U),T=r("0ec9"),$=r.n(T),j=r("f13c"),B=r.n(j),F=(r("f5df"),r("0fae"),r("a2f0"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{attrs:{id:"app"}},[r("router-view")],1)}),H=[],N={name:"app",mounted:function(){this.track.data.url&&this.story.data.url&&this.features.data.url||this.$router.push("/load")},computed:{features:function(){return this.$store.state.features},track:function(){return this.$store.state.track},story:function(){return this.$store.state.story}}},C=N,E=(r("5c0b"),r("2877")),I=Object(E["a"])(C,F,H,!1,null,null,null),R=I.exports,z=r("8c4f"),A=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-main",[r("el-row",[r("el-col",{attrs:{span:10,offset:7}},[r("h1",[t._v("Cartostory")]),r("el-form",{attrs:{"label-width":"120px"}},[t.availableStories.length>0?r("el-form-item",{attrs:{label:"Načíst příběh"}},[r("el-select",{attrs:{placeholder:"Příběh"},on:{change:t.handleStorySelect},model:{value:t.currentStory,callback:function(e){t.currentStory=e},expression:"currentStory"}},t._l(t.availableStories,(function(t){return r("el-option",{key:t.storyName,attrs:{label:t.storyName,value:t.storyName}})})),1)],1):t._e(),r("el-form-item",{attrs:{label:"Název příběhu"}},[r("el-input",{attrs:{type:"text"},model:{value:t.storyName,callback:function(e){t.storyName=e},expression:"storyName"}})],1),r("el-form-item",{attrs:{label:"URL trasy"}},[r("el-input",{attrs:{type:"text"},model:{value:t.trackUrl,callback:function(e){t.trackUrl=e},expression:"trackUrl"}})],1),r("el-form-item",{attrs:{label:"URL příběhu"}},[r("el-input",{attrs:{type:"text"},model:{value:t.storyUrl,callback:function(e){t.storyUrl=e},expression:"storyUrl"}})],1),r("el-form-item",{attrs:{label:"URL míst"}},[r("el-input",{attrs:{type:"text"},model:{value:t.featuresUrl,callback:function(e){t.featuresUrl=e},expression:"featuresUrl"}})],1),r("el-form-item",[r("el-button",{attrs:{disabled:t.disabledSubmit,type:"primary"},on:{click:t.handleSubmit}},[t._v("Načíst")])],1)],1)],1)],1)],1)},M=[],P=(r("7514"),{name:"CsLoadStoryForm",data:function(){return{currentStory:void 0,trackUrl:void 0,storyName:void 0,storyUrl:void 0,featuresUrl:void 0}},computed:{availableStories:function(){return this.$store.state.availableStories},disabledSubmit:function(){return!this.trackUrl||!this.storyUrl||!this.featuresUrl||!this.storyName}},methods:{handleSubmit:function(){var t={trackUrl:this.trackUrl,storyUrl:this.storyUrl,featuresUrl:this.featuresUrl};this.$store.dispatch("setUrls",t),this.$store.dispatch("setStoryName",this.storyName),this.$store.dispatch("loadStory"),this.$router.push("/")},handleStorySelect:function(t){var e=this,r=this.availableStories.find((function(t){return t.storyName===e.currentStory}));r&&(this.featuresUrl=r.featuresUrl,this.storyUrl=r.storyUrl,this.storyName=r.storyName,this.trackUrl=r.trackUrl)}}}),J=P,G=(r("bbec"),Object(E["a"])(J,A,M,!1,null,"175292f8",null)),D=G.exports,q=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{attrs:{id:"screen"}},[t.ready?t._e():r("pulse-loader",{staticClass:"spinner",attrs:{color:"#2c3e50"}}),t.ready?r("el-col",{attrs:{span:12}},[r("cs-map")],1):t._e(),t.ready?r("el-col",{attrs:{span:12}},[r("cs-story")],1):t._e()],1)},W=[],Y=r("8a5d"),V=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.story.story?r("div",{ref:"story",staticClass:"cs-story"},[r("router-link",{staticClass:"header-link",attrs:{title:"Nahrát jiný příběh",to:"/load"}},[r("el-button",{attrs:{size:"mini",type:"plain",icon:"el-icon-plus",circle:""}})],1),t.story.story.header?r("section",[r("header",[r("h1",[t._v(t._s(t.story.story.header))]),r("div",{staticClass:"perex"},t._l(t.story.story.perex,(function(e){return r("p",{staticClass:"sanitized",domProps:{innerHTML:t._s(t.sanitize(e))},on:{click:t.onTextClicked}},[t._v(t._s(e))])})),0)]),r("section",t._l(t.story.story.sections,(function(e){return r("section",{class:{"bbox-section":e.bbox,"bbox-section__active":e.bbox===t.bbox},attrs:{"data-bbox":e.bbox},on:{mouseenter:function(r){return t.onBboxHovered(e.bbox)},mouseleave:t.onBboxLeft}},[e.bbox?r("el-button",{attrs:{title:"Vycentrovat v mapě",size:"mini",type:"plain",icon:"el-icon-full-screen",circle:""},on:{click:function(r){return t.onBboxClicked(e.bbox)}}}):t._e(),r("h2",[t._v(t._s(e.header))]),r("div",t._l(e.text,(function(e){return r("p",{ref:"cstext",refInFor:!0,staticClass:"sanitized",domProps:{innerHTML:t._s(t.sanitize(e))},on:{click:t.onTextClicked}},[t._v(t._s(e))])})),0)],1)})),0)]):t._e()],1):t._e()},X=[],Z={data:function(){return{scrollTimeout:250,scrollTimeoutID:null}},computed:{bbox:function(){return this.$store.state.bbox},highlightedFeature:function(){return this.$store.state.highlightedFeature},story:function(){return this.$store.state.story.data},shouldScrollToFeature:function(){return this.$store.state.shouldScrollToFeature}},watch:{highlightedFeature:function(){this.shouldScrollToFeature&&this.scroll(),this.resetHighlightedLinks(),this.setHighlightedLink()}},methods:{onBboxClicked:function(t){this.$store.dispatch("setBbox",null),this.$store.dispatch("setBbox",t)},onBboxHovered:function(t){this.$store.dispatch("setBboxHovered",null),this.$store.dispatch("setBboxHovered",t)},onBboxLeft:function(){this.$store.dispatch("setBboxHovered",null)},scroll:function(){var t=this.highlightedFeature.properties.id,e=document.querySelectorAll("[data-cs-id='".concat(t,"']"))[0];this.$scrollTo(e,void 0,{container:"#story-container",offset:-50})},resetHighlightedLinks:function(){this.$store.dispatch("story/resetHighlightedLink")},setHighlightedLink:function(){this.$store.dispatch("story/setHighlightedLink")},sanitize:function(t){return this.$sanitize(t)},onTextClicked:function(t){var e=t.target;if("a"===e.localName&&e.attributes.getNamedItem("data-cs-id")){var r=e.attributes.getNamedItem("data-cs-id").value,o=this.$store.state.features.data.features.find((function(t){return t.properties.id==r}));this.resetHighlightedLinks(),o&&(this.$store.dispatch("setHighlightedFeature",o),this.$store.dispatch("setShouldScrollToFeature",!1),this.setHighlightedLink())}}}},K=Z,Q=(r("501e"),Object(E["a"])(K,V,X,!1,null,"3e645450",null)),tt=Q.exports,et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cs-map"},[r("div",{attrs:{id:"cs-map-container"}},[r("l-map",{ref:"csmap",attrs:{center:t.map.center,zoom:t.map.zoom}},[r("l-tile-layer",{attrs:{url:t.map.baseLayer}}),r("l-tile-layer",{attrs:{url:t.map.hikingOverlay,"layer-type":"overlay",opacity:.7}}),r("l-tile-layer",{attrs:{url:t.map.labelsOverlay,"layer-type":"overlay"}}),t.trackOutsideBbox||t.trackInsideBbox?t._e():r("l-geo-json",{ref:"cstrack",attrs:{geojson:t.track.track,options:t.trackOptions.style.plain}}),t.trackInsideBbox?r("l-geo-json",{ref:"cstrack",attrs:{geojson:t.trackInsideBbox,options:t.trackOptions.style.inBbox}}):t._e(),t.trackOutsideBbox?r("l-geo-json",{ref:"cstrack",attrs:{geojson:t.trackOutsideBbox,options:t.trackOptions.style.plain}}):t._e(),t.bboxHovered&&t.bboxHoveredDifferentFromCurrentBbox?r("l-rectangle",{attrs:{bounds:t.bboxHovered,"l-style":t.bboxOptions.hovered.style}}):t._e(),t.bbox?r("l-rectangle",{attrs:{bounds:t.bbox,"l-style":t.bboxOptions.selected.style}}):t._e(),t.highlightedFeature?r("l-circle-marker",{attrs:{color:t.markerOptions.style.highlighted.color,"fill-color":t.markerOptions.style.highlighted.color,"fill-opacity":t.markerOptions.style.highlighted.fillOpacity,latLng:[t.highlightedFeature.geometry.coordinates[1],t.highlightedFeature.geometry.coordinates[0]],radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:function(e){return t.featureClicked(t.highlightedFeature)}}}):t._e(),t._l(t.features,(function(e){return r("l-circle-marker",{key:e.properties.id,attrs:{color:t.markerOptions.style.plain.color,"fill-color":t.markerOptions.style.plain.color,"fill-opacity":t.markerOptions.style.plain.fillOpacity,latLng:[e.geometry.coordinates[1],e.geometry.coordinates[0]],radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:function(r){return t.featureClicked(e)}}})})),t._l(t.featuresInsideBbox,(function(e){return r("l-circle-marker",{key:e.properties.id,attrs:{color:t.markerOptions.style.inBbox.color,"fill-color":t.markerOptions.style.inBbox.color,"fill-opacity":t.markerOptions.style.inBbox.fillOpacity,latLng:[e.geometry.coordinates[1],e.geometry.coordinates[0]],radius:t.markerOptions.style.common.radius,weight:t.markerOptions.style.common.weight},on:{click:function(r){return t.featureClicked(e)}}})}))],2)],1)])},rt=[],ot=(r("6762"),r("2fdb"),r("ea97")),at=r("044a"),nt=r("2699"),it=r("a40a"),st=r("fb8e"),lt=r("3d9d");r("6cc5");var ct={name:"CsMap",components:{LCircleMarker:ot["a"],LGeoJson:at["a"],LMap:nt["a"],LTileLayer:it["a"],LRectangle:st["a"]},data:function(){return{map:{bounds:null,center:[50,19],baseLayer:"https://api.mapbox.com/styles/v1/cartostory/cjugqcypf27581gnry4y59lxy/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",hikingOverlay:"http://tile.mtbmap.cz/overlay_hiking/{z}/{x}/{y}.png",labelsOverlay:"https://api.mapbox.com/styles/v1/cartostory/cjugqfe8r1lhh1ftgrmr7v9zj/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2FydG9zdG9yeSIsImEiOiJjanQycXVyZDcxeXZqM3lxeDNvcW81NWJpIn0.hfvoqNSy7dT0yviVhNcDMg",zoom:8,edgeMarker:null},markerOptions:{style:{common:{radius:8,weight:1},highlighted:{color:"#fffc31",fillOpacity:.8},inBbox:{color:"#42b983",fillOpacity:.5},plain:{color:"#3185fc",fillOpacity:.5},edge:{icon:L.icon({iconUrl:"../../node_modules/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]})}}},bboxOptions:{hovered:{style:{color:"#5a5a66",fillColor:"#5a5a66",dashArray:"5",weight:2}},selected:{style:{color:"#42b983",fillColor:"#42b983",fillOpacity:0,dashArray:"5",weight:2}}},trackOptions:{style:{plain:{color:"#5a5a66",dashArray:"6"},inBbox:{color:"#42b983",dashArray:"6"}}}}},methods:{featureClicked:function(t){this.$store.dispatch("story/resetHighlightedLink"),this.$store.dispatch("setHighlightedFeature",t),this.$store.dispatch("setShouldScrollToFeature",!0),this.map.center=this.$refs.csmap.mapObject.getBounds().getCenter()},flyTo:function(t){var e=[t.geometry.coordinates[1],t.geometry.coordinates[0]];this.$refs.csmap.mapObject.flyTo(e)}},mounted:function(){var t=this;this.$nextTick((function(){t.map.bounds=t.$refs.cstrack&&t.$refs.cstrack.getBounds(),t.$refs.csmap&&t.$refs.csmap.mapObject.fitBounds(t.map.bounds)}))},computed:{bbox:function(){return this.$store.state.bbox},bboxHovered:function(){return this.$store.state.bboxHovered},bboxHoveredDifferentFromCurrentBbox:function(){return this.bbox!==this.bboxHovered},features:function(){if(this.highlightedFeature||this.featuresInsideBbox){var t=[this.highlightedFeature&&this.highlightedFeature.properties.id],e=this.featuresInsideBbox&&this.featuresInsideBbox.map((function(t){return t.properties.id})),r=t.concat(e);return this.$store.state.features.data.features.filter((function(t){return!r.includes(t.properties.id)}))}return this.$store.state.features.data.features},featuresInsideBbox:function(){return this.$store.getters["track/featuresInsideBbox"]},highlightedFeature:function(){return this.$store.state.highlightedFeature},track:function(){return this.$store.state.track.data},trackInsideBbox:function(){return this.$store.getters["track/trackBboxRelation"]("within")},trackOutsideBbox:function(){return this.$store.getters["track/trackBboxRelation"]("disjoint")}},watch:{highlightedFeature:function(){this.flyTo(this.highlightedFeature)},bbox:function(){this.bbox&&this.$refs.csmap.mapObject.flyToBounds(this.bbox)},bboxHovered:function(){var t=L.icon({iconUrl:"img/map-marker.svg",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0]});if(this.bboxHovered){var e=L.latLngBounds(this.bboxHovered).getCenter();this.map.edgeMarker=new lt(e,{icon:t}),this.$refs.csmap.mapObject.addLayer(this.map.edgeMarker)}else this.$refs.csmap.mapObject.removeLayer(this.map.edgeMarker)}}},ut=ct,dt=(r("dbbc"),Object(E["a"])(ut,et,rt,!1,null,null,null)),ft=dt.exports,ht={name:"CsScreen",components:{CsStory:tt,CsMap:ft,PulseLoader:Y["a"]},mounted:function(){this.readyAndNotDownloadedYet&&this.$store.dispatch("loadStory")},computed:{features:function(){return this.$store.state.features},track:function(){return this.$store.state.track},story:function(){return this.$store.state.story},ready:function(){return this.track.data.track&&this.story.data.story},readyAndNotDownloadedYet:function(){return this.features.data.url&&this.track.data.url&&this.story.data.url&&!this.ready}}},pt=ht,bt=(r("f0fb"),Object(E["a"])(pt,q,W,!1,null,"24e91587",null)),mt=bt.exports;S["default"].use(z["a"]);var yt,gt=[{path:"/",component:mt},{path:"/load",component:D}],vt=new z["a"]({mode:"history",base:"/cartostory-frontend/",routes:gt}),kt=r("bd86"),xt=(r("ac6a"),r("96cf"),r("3b8d")),Ot=(r("7f7f"),r("bfa9")),St=r("bc3a"),_t=r.n(St),Ut=function(t){return t[t.length-1]},wt=function(t){return function(e,r){e[t]=r}},Tt=function(t){return function(e,r){var o=t.slice(0,-1).reduce((function(e,r,o){return r in e||(e[r]="number"===typeof t[o+1]?[]:{}),e[r]}),e);o[Ut(t)]=r}},$t={data:{url:null,features:null}},jt={loadFeatures:function(){var t=Object(xt["a"])(regeneratorRuntime.mark((function t(e){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,o=e.state,t.prev=1,t.next=4,_t.a.get(o.data.url);case 4:a=t.sent,r("setFeatures",a.data),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},Lt={getFeatureById:function(t){return function(e){if(t.data.features)return t.data.features.find((function(t){return t.properties.id==e}))}}},Bt={setFeatures:Tt(["data","features"])},Ft={namespaced:!0,actions:jt,state:$t,getters:Lt,mutations:Bt},Ht=Ft,Nt="RESET_HIGHLIGHTED_LINK",Ct="SET_BBOX",Et="SET_BBOX_HOVERED",It="SET_FEATURES_URL",Rt="SET_HIGHLIGHTED_FEATURE",zt="SET_SHOULD_SCROLL_TO_FEATURE",At="SET_STORY_NAME",Mt="SET_STORY_URL",Pt="SET_TRACK_URL",Jt="SET_STORY",Gt="SET_TRACK",Dt={data:{name:void 0,url:void 0,story:void 0}},qt={setHighlightedLink:function(t){var e=t.commit;e("setHighlightedLink",void 0,{root:!0})},resetHighlightedLink:function(t){var e=t.commit;e(Nt,void 0,{root:!0})},loadText:function(){var t=Object(xt["a"])(regeneratorRuntime.mark((function t(e){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,o=e.state,t.prev=1,t.next=4,_t.a.get(o.data.url);case 4:a=t.sent,r(Jt,a.data),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},Wt=Object(kt["a"])({},Jt,Tt(["data","story"])),Yt={namespaced:!0,state:Dt,actions:qt,mutations:Wt},Vt=Yt,Xt=r("595b"),Zt={booleanPointInPolygon:Xt["booleanPointInPolygon"],featureCollection:Xt["featureCollection"],lineSplit:Xt["lineSplit"],lineString:Xt["lineString"],point:Xt["point"],pointsWithinPolygon:Xt["pointsWithinPolygon"]},Kt={namespaced:!0,state:{data:{url:null,track:null}},mutations:Object(kt["a"])({},Gt,Tt(["data","track"])),actions:{loadTrack:function(){var t=Object(xt["a"])(regeneratorRuntime.mark((function t(e){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,o=e.state,t.prev=1,t.next=4,_t.a.get(o.data.url);case 4:a=t.sent,r(Gt,a.data),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},getters:{bboxGeoJson:function(t,e,r){return r.bbox&&L.rectangle(r.bbox).toGeoJSON()},featuresInsideBbox:function(t,e,r){if(!e.bboxGeoJson)return null;var o=r.features.data.features,a=Zt.featureCollection(o),n=Zt.pointsWithinPolygon(a,e.bboxGeoJson);return n&&n.features},trackBboxRelation:function(t,e,r){return function(t){var o=["within","disjoint"];if(!o.includes(t))throw new Error("bbox relation not recognized, use one of ".concat(o.join(", ")));if(!e.bboxGeoJson)return null;var a=[],n=r.track.data.track.features[0],i=n.geometry.coordinates;return i.forEach((function(r){var o=Zt.lineSplit(Zt.lineString(r),e.bboxGeoJson),n=Zt.booleanPointInPolygon(Object(Xt["point"])(r[0]),e.bboxGeoJson)?0:1;o.features.forEach((function(e,r){var o="disjoint"===t?(r+n)%2!==0:(r+n)%2===0;o&&a.push(e)}))})),Zt.featureCollection(a)}}}},Qt=Kt;S["default"].use(_["a"]);var te="cartostory",ee=new Ot["a"]({key:te,storage:window.localStorage,strictMode:!0,reducer:function(t){return{storyName:t.story.data.name,storyUrl:t.story.data.url,featuresUrl:t.features.data.url,trackUrl:t.track.data.url}},saveState:function(t,e,r){var o=e.storyName,a=e.storyUrl,n=e.featuresUrl,i=e.trackUrl,s=JSON.parse(r.getItem(t))||[];o&&a&&n&&i&&(s.find((function(t){return t.storyName===o&&t.storyUrl===a&&t.featuresUrl===n&&t.trackUrl===i}))||(s.push(e),r.setItem(t,JSON.stringify(s))))},restoreState:function(t,e){return JSON.parse(e.getItem(t))||[]}}),re=[ee.plugin],oe={availableStories:[],bbox:void 0,bboxHovered:void 0,highlightedFeature:void 0,shouldScrollToFeature:void 0},ae={setBbox:function(t,e){var r=t.commit;r(Ct,e)},setBboxHovered:function(t,e){var r=t.commit;r(Et,e)},setHighlightedFeature:function(t,e){var r=t.commit;r(Ct,null),r(Rt,e)},setShouldScrollToFeature:function(t,e){var r=t.commit;r(zt,e)},setStoryName:function(t,e){var r=t.commit;r(At,e)},setUrls:function(t,e){var r=t.commit;r(It,e.featuresUrl),r(Mt,e.storyUrl),r(Pt,e.trackUrl)},loadStory:function(){var t=Object(xt["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,r("story/loadText",{root:!0});case 3:return t.next=5,r("track/loadTrack",{root:!0});case 5:return t.next=7,r("features/loadFeatures",{root:!0});case 7:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},ne={features:Ht,story:Vt,track:Qt},ie=(yt={RESTORE_MUTATION:function(t,e){e&&(t.features.data.url=e[0]&&e[0].featuresUrl,t.story.data.url=e[0]&&e[0].storyUrl,t.story.data.name=e[0]&&e[0].storyName,t.track.data.url=e[0]&&e[0].trackUrl,t.availableStories=e)}},Object(kt["a"])(yt,Rt,wt("highlightedFeature")),Object(kt["a"])(yt,Ct,wt("bbox")),Object(kt["a"])(yt,Et,wt("bboxHovered")),Object(kt["a"])(yt,zt,wt("shouldScrollToFeature")),Object(kt["a"])(yt,It,Tt(["features","data","url"])),Object(kt["a"])(yt,At,Tt(["story","data","name"])),Object(kt["a"])(yt,Mt,Tt(["story","data","url"])),Object(kt["a"])(yt,Pt,Tt(["track","data","url"])),Object(kt["a"])(yt,Nt,(function(){document.querySelectorAll("[data-cs-id]").forEach((function(t){t.classList&&t.classList.remove("highlighted")}))})),Object(kt["a"])(yt,"setHighlightedLink",(function(t){if(t.highlightedFeature){var e=t.highlightedFeature.properties.id,r=document.querySelectorAll("[data-cs-id='".concat(e,"']"))[0];t.highlightedFeature&&r&&r.classList.add("highlighted")}})),yt),se={strict:!0,modules:ne,state:oe,mutations:ie,actions:ae,plugins:re};S["default"].config.productionTip=!1,S["default"].use(O.a),S["default"].use(k.a),S["default"].use(g.a),S["default"].use(m.a),S["default"].use(p.a),S["default"].use(f.a),S["default"].use(u.a),S["default"].use(l.a),S["default"].use(i.a),S["default"].use(a.a),S["default"].use(w.a),S["default"].use(B.a),S["default"].use(_["a"]),S["default"].use($.a,{allowedTags:["a"],allowedAttributes:{a:["data-url","id","data-cs-id"]}}),new S["default"]({router:vt,store:new _["a"].Store(se),render:function(t){return t(R)}}).$mount("#cartostory")},"5c0b":function(t,e,r){"use strict";var o=r("5e27"),a=r.n(o);a.a},"5e27":function(t,e,r){},"7e5f":function(t,e,r){},"7fae":function(t,e,r){},8922:function(t,e,r){},"8f53":function(t,e,r){},a2f0:function(t,e,r){},bbec:function(t,e,r){"use strict";var o=r("7fae"),a=r.n(o);a.a},dbbc:function(t,e,r){"use strict";var o=r("8f53"),a=r.n(o);a.a},f0fb:function(t,e,r){"use strict";var o=r("8922"),a=r.n(o);a.a}});
//# sourceMappingURL=app.5c451c97.js.map