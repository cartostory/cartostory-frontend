version: '3.7'
services:
    web:
        image: "nginx:latest"
        command: [nginx-debug, '-g', 'daemon off;']
        ports:
            - "5000:80"
        volumes:
            - ./etc/nginx/conf.d/cartostory.conf:/etc/nginx/conf.d/default.conf
    client:
        image: cartostory-frontend:latest
        ports:
            - "8080:8080"
        build:
            context: .
            dockerfile: Dockerfile.dev
        command: run serve
        volumes:
            - ./__mocks__:/opt/app/__mocks__
            - ./.env:/opt/app/.env
            - ./.eslintrc.js:/opt/app/.eslintrc.js
            - ./auth_config.json:/opt/app/auth_config.json
            - ./babel.config.js:/opt/app/babel.config.js
            - ./jest.config.js:/opt/app/jest.config.js
            - ./package.json:/opt/app/package.json
            - ./public:/opt/app/public
            - ./src:/opt/app/src
            - ./tests:/opt/app/tests
            - ./vue.config.js:/opt/app/vue.config.js
networks:
    default:
        name: cartostory-net
